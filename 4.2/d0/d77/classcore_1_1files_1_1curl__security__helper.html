<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: core\files\curl_security_helper Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.2</span>
   </div>
   <div id="projectbrief">Moodle 4.2.6 (Build: 20240212) (6acc0648d89)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/d0f/namespacecore.html">core</a></li><li class="navelem"><a class="el" href="../../db/d69/namespacecore_1_1files.html">files</a></li><li class="navelem"><a class="el" href="../../d0/d77/classcore_1_1files_1_1curl__security__helper.html">curl_security_helper</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../de/d2d/classcore_1_1files_1_1curl__security__helper-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">core\files\curl_security_helper Class Reference<div class="ingroups"><a class="el" href="../../d0/de1/group__core.html">core</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Host and port checking for curl.  
 <a href="#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for core\files\curl_security_helper:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d0/d77/classcore_1_1files_1_1curl__security__helper.png" usemap="#core_5Cfiles_5Ccurl_5Fsecurity_5Fhelper_map" alt=""/>
  <map id="core_5Cfiles_5Ccurl_5Fsecurity_5Fhelper_map" name="core_5Cfiles_5Ccurl_5Fsecurity_5Fhelper_map">
<area href="../../d8/df2/classcore_1_1files_1_1curl__security__helper__base.html" title="Security helper for the curl class." alt="core\files\curl_security_helper_base" shape="rect" coords="0,0,220,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a59b9178d4aa95c56306a06b064a6e47a" id="r_a59b9178d4aa95c56306a06b064a6e47a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59b9178d4aa95c56306a06b064a6e47a">get_blocked_url_string</a> ()</td></tr>
<tr class="memdesc:a59b9178d4aa95c56306a06b064a6e47a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a string message describing a blocked URL.  <br /></td></tr>
<tr class="separator:a59b9178d4aa95c56306a06b064a6e47a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ec7030c66d97c17350243dd6b0ccf1" id="r_a94ec7030c66d97c17350243dd6b0ccf1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94ec7030c66d97c17350243dd6b0ccf1">is_enabled</a> ()</td></tr>
<tr class="memdesc:a94ec7030c66d97c17350243dd6b0ccf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience method to check whether we have any entries in the host blocklist or ports allowlist admin settings.  <br /></td></tr>
<tr class="separator:a94ec7030c66d97c17350243dd6b0ccf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7d8b6bdb4ea5d8120fe98308c416ed2" id="r_ae7d8b6bdb4ea5d8120fe98308c416ed2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/df2/classcore_1_1files_1_1curl__security__helper__base.html#ae7d8b6bdb4ea5d8120fe98308c416ed2">url_is_blocked</a> ($url)</td></tr>
<tr class="memdesc:ae7d8b6bdb4ea5d8120fe98308c416ed2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the input url should be blocked or not.  <br /></td></tr>
<tr class="separator:ae7d8b6bdb4ea5d8120fe98308c416ed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a850c56a279bc320336befd31ab24446e" id="r_a850c56a279bc320336befd31ab24446e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a850c56a279bc320336befd31ab24446e">url_is_blocked</a> ($urlstring, $notused=null)</td></tr>
<tr class="memdesc:a850c56a279bc320336befd31ab24446e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the given URL is blocked by checking its address and port number against the allow/block lists.  <br /></td></tr>
<tr class="separator:a850c56a279bc320336befd31ab24446e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aa950a3429e2618fa8525ca0e164771c4" id="r_aa950a3429e2618fa8525ca0e164771c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa950a3429e2618fa8525ca0e164771c4">address_explicitly_blocked</a> ($addr)</td></tr>
<tr class="memdesc:aa950a3429e2618fa8525ca0e164771c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the input address is blocked by at any of the IPv4 or <a class="el" href="../../db/d24/class_i_pv6.html" title="Class to validate and to work with IPv6 addresses.">IPv6</a> address rules.  <br /></td></tr>
<tr class="separator:aa950a3429e2618fa8525ca0e164771c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0af1cb271fb89ce58e42fb855317260" id="r_aa0af1cb271fb89ce58e42fb855317260"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa0af1cb271fb89ce58e42fb855317260">get_allowed_ports</a> ()</td></tr>
<tr class="memdesc:aa0af1cb271fb89ce58e42fb855317260"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper that returns the allowed ports, as defined in the 'curlsecurityallowedport' setting.  <br /></td></tr>
<tr class="separator:aa0af1cb271fb89ce58e42fb855317260"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1877a4dd731cdbc80aa2bfb11b59f6e7" id="r_a1877a4dd731cdbc80aa2bfb11b59f6e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1877a4dd731cdbc80aa2bfb11b59f6e7">get_blocked_hosts</a> ()</td></tr>
<tr class="memdesc:a1877a4dd731cdbc80aa2bfb11b59f6e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper that returns the blocked hosts, as defined in the 'curlsecurityblockedhosts' setting.  <br /></td></tr>
<tr class="separator:a1877a4dd731cdbc80aa2bfb11b59f6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0573b71af22019f79c0ca91112b3ec79" id="r_a0573b71af22019f79c0ca91112b3ec79"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0573b71af22019f79c0ca91112b3ec79">get_blocked_hosts_by_category</a> ()</td></tr>
<tr class="memdesc:a0573b71af22019f79c0ca91112b3ec79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to get all entries from the admin setting, as an array, sorted by classification.  <br /></td></tr>
<tr class="separator:a0573b71af22019f79c0ca91112b3ec79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5abe30b0f16fdba6e4d1df2f293cc363" id="r_a5abe30b0f16fdba6e4d1df2f293cc363"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5abe30b0f16fdba6e4d1df2f293cc363">get_host_list_by_name</a> ($host)</td></tr>
<tr class="memdesc:a5abe30b0f16fdba6e4d1df2f293cc363"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve all hosts for a domain name.  <br /></td></tr>
<tr class="separator:a5abe30b0f16fdba6e4d1df2f293cc363"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a472e246350e26167fa84bae65ae0a958" id="r_a472e246350e26167fa84bae65ae0a958"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a472e246350e26167fa84bae65ae0a958">host_explicitly_blocked</a> ($host)</td></tr>
<tr class="memdesc:a472e246350e26167fa84bae65ae0a958"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the input hostname is blocked by any of the domain/wildcard rules.  <br /></td></tr>
<tr class="separator:a472e246350e26167fa84bae65ae0a958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a607fca2addcc5ef9c708454807dbc10d" id="r_a607fca2addcc5ef9c708454807dbc10d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a607fca2addcc5ef9c708454807dbc10d">host_is_blocked</a> ($host)</td></tr>
<tr class="memdesc:a607fca2addcc5ef9c708454807dbc10d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the host portion of a url is blocked.  <br /></td></tr>
<tr class="separator:a607fca2addcc5ef9c708454807dbc10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a327fea715258943823aa4a1055f1bbb9" id="r_a327fea715258943823aa4a1055f1bbb9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a327fea715258943823aa4a1055f1bbb9">port_is_blocked</a> ($port)</td></tr>
<tr class="memdesc:a327fea715258943823aa4a1055f1bbb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the given port is blocked, as determined by its absence on the ports allowlist.  <br /></td></tr>
<tr class="separator:a327fea715258943823aa4a1055f1bbb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a82cdbb6ebf27bb8f04c827ec7ae2d452" id="r_a82cdbb6ebf27bb8f04c827ec7ae2d452"><td class="memItemLeft" align="right" valign="top">array&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82cdbb6ebf27bb8f04c827ec7ae2d452">$transportschemes</a></td></tr>
<tr class="memdesc:a82cdbb6ebf27bb8f04c827ec7ae2d452"><td class="mdescLeft">&#160;</td><td class="mdescRight">of supported transport schemes and their respective default ports.  <br /></td></tr>
<tr class="separator:a82cdbb6ebf27bb8f04c827ec7ae2d452"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Host and port checking for curl. </p>
<p>This class provides a means to check URL/host/port against the system-level cURL security entries. It does not provide a means to add URLs, hosts or ports to the allowed/blocked lists; this is configured manually via the site admin section of <a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> (See: 'Site admin' &gt; 'Security' &gt; 'HTTP Security').</p>
<p>This class is currently used by the 'curl' wrapper class in lib/filelib.php. Depends on: <a class="el" href="../../df/d87/classcore_1_1ip__utils.html" title="Static helper class providing some useful internet-protocol-related functions.">core::ip_utils</a> (several functions) moodlelib (clean_param)</p>
<dl class="section copyright"><dt>Copyright</dt><dd>2016 Jake Dallimore </dd></dl>
<dl class="section user"><dt>License</dt><dd><a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> GNU GPL v3 or later </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Jake Dallimore <a href="#" onclick="location.href='mai'+'lto:'+'jrh'+'da'+'lli'+'mo'+'re@'+'gm'+'ail'+'.c'+'om'; return false;">jrhda<span class="obfuscator">.nosp@m.</span>llim<span class="obfuscator">.nosp@m.</span>ore@g<span class="obfuscator">.nosp@m.</span>mail<span class="obfuscator">.nosp@m.</span>.com</a> </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aa950a3429e2618fa8525ca0e164771c4" name="aa950a3429e2618fa8525ca0e164771c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa950a3429e2618fa8525ca0e164771c4">&#9670;&#160;</a></span>address_explicitly_blocked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::address_explicitly_blocked </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$addr</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks whether the input address is blocked by at any of the IPv4 or <a class="el" href="../../db/d24/class_i_pv6.html" title="Class to validate and to work with IPv6 addresses.">IPv6</a> address rules. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$addr</td><td>the ip address to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if the address is covered by an entry in the blocklist, false otherwise. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa0af1cb271fb89ce58e42fb855317260" name="aa0af1cb271fb89ce58e42fb855317260"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0af1cb271fb89ce58e42fb855317260">&#9670;&#160;</a></span>get_allowed_ports()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::get_allowed_ports </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper that returns the allowed ports, as defined in the 'curlsecurityallowedport' setting. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>the array of allowed ports. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1877a4dd731cdbc80aa2bfb11b59f6e7" name="a1877a4dd731cdbc80aa2bfb11b59f6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1877a4dd731cdbc80aa2bfb11b59f6e7">&#9670;&#160;</a></span>get_blocked_hosts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::get_blocked_hosts </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper that returns the blocked hosts, as defined in the 'curlsecurityblockedhosts' setting. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>the array of blocked host entries. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0573b71af22019f79c0ca91112b3ec79" name="a0573b71af22019f79c0ca91112b3ec79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0573b71af22019f79c0ca91112b3ec79">&#9670;&#160;</a></span>get_blocked_hosts_by_category()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::get_blocked_hosts_by_category </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper to get all entries from the admin setting, as an array, sorted by classification. </p>
<p>Classifications include 'ipv4', 'ipv6', 'domain', 'domainwildcard'.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>of host/domain/ip entries from the 'curlsecurityblockedhosts' config. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a59b9178d4aa95c56306a06b064a6e47a" name="a59b9178d4aa95c56306a06b064a6e47a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59b9178d4aa95c56306a06b064a6e47a">&#9670;&#160;</a></span>get_blocked_url_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::get_blocked_url_string </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a string message describing a blocked URL. </p>
<p>E.g. 'This URL is blocked'.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>the string error. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="../../d8/df2/classcore_1_1files_1_1curl__security__helper__base.html#a233062023bf535648cfb3820929dacdf">core\files\curl_security_helper_base</a>.</p>

</div>
</div>
<a id="a5abe30b0f16fdba6e4d1df2f293cc363" name="a5abe30b0f16fdba6e4d1df2f293cc363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5abe30b0f16fdba6e4d1df2f293cc363">&#9670;&#160;</a></span>get_host_list_by_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::get_host_list_by_name </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$host</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve all hosts for a domain name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$param</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>An array of IPs associated with the host name. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a472e246350e26167fa84bae65ae0a958" name="a472e246350e26167fa84bae65ae0a958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a472e246350e26167fa84bae65ae0a958">&#9670;&#160;</a></span>host_explicitly_blocked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::host_explicitly_blocked </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$host</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks whether the input hostname is blocked by any of the domain/wildcard rules. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$host</td><td>the hostname to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if the host is covered by an entry in the blocklist, false otherwise. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a607fca2addcc5ef9c708454807dbc10d" name="a607fca2addcc5ef9c708454807dbc10d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a607fca2addcc5ef9c708454807dbc10d">&#9670;&#160;</a></span>host_is_blocked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::host_is_blocked </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$host</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks whether the host portion of a url is blocked. </p>
<p>The host portion may be a FQDN, IPv4 address or a <a class="el" href="../../db/d24/class_i_pv6.html" title="Class to validate and to work with IPv6 addresses.">IPv6</a> address wrapped in square brackets, as per standard URL notation. E.g. images.example.com 127.0.0.1 [0.0.0.0.0.0.0.1] The method logic is as follows:</p><ol type="1">
<li>Check the host component against the list of IPv4/IPv6 addresses and ranges.<ul>
<li>This will perform a DNS forward lookup if required.</li>
</ul>
</li>
<li>Check the host component against the list of domain names and wildcard domain names.<ul>
<li>This will perform a DNS reverse lookup if required.</li>
</ul>
</li>
</ol>
<p>The behaviour of this function can be classified as strict, as it returns true for hosts which are invalid or could not be parsed, as well as those valid URLs which were found in the blocklist.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$host</td><td>the host component of the URL to check against the blocklist. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if the host is both valid and blocked, false otherwise. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a94ec7030c66d97c17350243dd6b0ccf1" name="a94ec7030c66d97c17350243dd6b0ccf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ec7030c66d97c17350243dd6b0ccf1">&#9670;&#160;</a></span>is_enabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::is_enabled </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convenience method to check whether we have any entries in the host blocklist or ports allowlist admin settings. </p>
<p>If no entries are found at all, the assumption is that the blocklist is disabled entirely.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if one or more entries exist, false otherwise. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a327fea715258943823aa4a1055f1bbb9" name="a327fea715258943823aa4a1055f1bbb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a327fea715258943823aa4a1055f1bbb9">&#9670;&#160;</a></span>port_is_blocked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::port_is_blocked </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$port</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks whether the given port is blocked, as determined by its absence on the ports allowlist. </p>
<p>Ports are assumed to be blocked unless found in the allowlist.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">integer&#160;|&#160;string</td><td class="paramname">$port</td><td>the port to check against the ports allowlist. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if the port is blocked, false otherwise. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae7d8b6bdb4ea5d8120fe98308c416ed2" name="ae7d8b6bdb4ea5d8120fe98308c416ed2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7d8b6bdb4ea5d8120fe98308c416ed2">&#9670;&#160;</a></span>url_is_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper_base::url_is_blocked </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$url</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">abstract</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check whether the input url should be blocked or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$url</td><td>the url to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if the url is deemed to be blocked, false otherwise. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a850c56a279bc320336befd31ab24446e" name="a850c56a279bc320336befd31ab24446e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a850c56a279bc320336befd31ab24446e">&#9670;&#160;</a></span>url_is_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core\files\curl_security_helper::url_is_blocked </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$urlstring</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$notused</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether the given URL is blocked by checking its address and port number against the allow/block lists. </p>
<p>The behaviour of this function can be classified as strict, as it returns true for URLs which are invalid or could not be parsed, as well as those valid URLs which were found in the blocklist.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$urlstring</td><td>the URL to check. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$notused</td><td>There used to be an optional parameter $maxredirects for a short while here, not used any more. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if the URL is blocked or invalid and false if the URL is not blocked. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a82cdbb6ebf27bb8f04c827ec7ae2d452" name="a82cdbb6ebf27bb8f04c827ec7ae2d452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82cdbb6ebf27bb8f04c827ec7ae2d452">&#9670;&#160;</a></span>$transportschemes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">array core\files\curl_security_helper::$transportschemes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= [</div>
<div class="line">        <span class="stringliteral">&#39;http&#39;</span> =&gt; 80,</div>
<div class="line">        <span class="stringliteral">&#39;https&#39;</span> =&gt; 443</div>
<div class="line">    ]</div>
</div><!-- fragment -->
<p>of supported transport schemes and their respective default ports. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lib/classes/files/<b>curl_security_helper.php</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Feb 11 2024 02:24:05 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
