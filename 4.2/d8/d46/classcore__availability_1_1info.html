<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: core_availability\info Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.2</span>
   </div>
   <div id="projectbrief">Moodle 4.2.7+ (Build: 20240425) (7b172f51b99)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/d10/namespacecore__availability.html">core_availability</a></li><li class="navelem"><a class="el" href="../../d8/d46/classcore__availability_1_1info.html">info</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="../../da/db5/classcore__availability_1_1info-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">core_availability\info Class Reference<div class="ingroups"><a class="el" href="../../de/d6c/group__core__availability.html">core_availability</a></div></div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="../../d9/da0/interface_base.html" title="Base for cache objects.">Base</a> class for conditional availability information (for module or section).  
 <a href="#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for core_availability\info:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d8/d46/classcore__availability_1_1info.png" usemap="#core_5Favailability_5Cinfo_map" alt=""/>
  <map id="core_5Favailability_5Cinfo_map" name="core_5Favailability_5Cinfo_map">
<area href="../../d6/d6a/classcore__availability_1_1info__module.html" title="Class handles conditional availability information for an activity." alt="core_availability\info_module" shape="rect" coords="0,56,177,80"/>
<area href="../../dc/df0/classcore__availability_1_1info__section.html" title="Class handles conditional availability information for a section." alt="core_availability\info_section" shape="rect" coords="187,56,364,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0eac6366729c12a6dce98384718cdc2b" id="r_a0eac6366729c12a6dce98384718cdc2b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0eac6366729c12a6dce98384718cdc2b">__construct</a> ($course, $visible, $availability)</td></tr>
<tr class="memdesc:a0eac6366729c12a6dce98384718cdc2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs with item details.  <br /></td></tr>
<tr class="separator:a0eac6366729c12a6dce98384718cdc2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc49a6e08c01d79cdbaf31f98fd9cd7" id="r_aafc49a6e08c01d79cdbaf31f98fd9cd7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aafc49a6e08c01d79cdbaf31f98fd9cd7">filter_user_list</a> (array $users)</td></tr>
<tr class="memdesc:aafc49a6e08c01d79cdbaf31f98fd9cd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests against a user list.  <br /></td></tr>
<tr class="separator:aafc49a6e08c01d79cdbaf31f98fd9cd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45efe50551cd888084d081d4bbd586c" id="r_ae45efe50551cd888084d081d4bbd586c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae45efe50551cd888084d081d4bbd586c">get_availability_tree</a> ()</td></tr>
<tr class="memdesc:ae45efe50551cd888084d081d4bbd586c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the availability tree, decoding it if not already done.  <br /></td></tr>
<tr class="separator:ae45efe50551cd888084d081d4bbd586c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c6cf5b658954982b289ce35322aa8e" id="r_aa0c6cf5b658954982b289ce35322aa8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa0c6cf5b658954982b289ce35322aa8e">get_context</a> ()</td></tr>
<tr class="memdesc:aa0c6cf5b658954982b289ce35322aa8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets context used for checking capabilities for this item.  <br /></td></tr>
<tr class="separator:aa0c6cf5b658954982b289ce35322aa8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16a40d25e0bf14377f9db1cad7a25bfb" id="r_a16a40d25e0bf14377f9db1cad7a25bfb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16a40d25e0bf14377f9db1cad7a25bfb">get_course</a> ()</td></tr>
<tr class="memdesc:a16a40d25e0bf14377f9db1cad7a25bfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtains the course associated with this availability information.  <br /></td></tr>
<tr class="separator:a16a40d25e0bf14377f9db1cad7a25bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8209d443cf4ba567b3f48df93cde89e0" id="r_a8209d443cf4ba567b3f48df93cde89e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8209d443cf4ba567b3f48df93cde89e0">get_full_information</a> (\<a class="el" href="../../d5/d26/classcourse__modinfo.html">course_modinfo</a> $modinfo=null)</td></tr>
<tr class="memdesc:a8209d443cf4ba567b3f48df93cde89e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtains a string describing all availability restrictions (even if they do not apply any more).  <br /></td></tr>
<tr class="separator:a8209d443cf4ba567b3f48df93cde89e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bf62ee25f5c25148ef8c18336af8428" id="r_a3bf62ee25f5c25148ef8c18336af8428"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3bf62ee25f5c25148ef8c18336af8428">get_groups</a> (int $groupingid=0)</td></tr>
<tr class="memdesc:a3bf62ee25f5c25148ef8c18336af8428"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns groups that the current user belongs to on the course.  <br /></td></tr>
<tr class="separator:a3bf62ee25f5c25148ef8c18336af8428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed37d0a4634c7530377f8982b8ce98e5" id="r_aed37d0a4634c7530377f8982b8ce98e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed37d0a4634c7530377f8982b8ce98e5">get_modinfo</a> ()</td></tr>
<tr class="memdesc:aed37d0a4634c7530377f8982b8ce98e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtains the modinfo associated with this availability information.  <br /></td></tr>
<tr class="separator:aed37d0a4634c7530377f8982b8ce98e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4b70f9f65e41467111c0d5e14984001" id="r_ad4b70f9f65e41467111c0d5e14984001"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4b70f9f65e41467111c0d5e14984001">get_user_list_sql</a> ($onlyactive)</td></tr>
<tr class="memdesc:ad4b70f9f65e41467111c0d5e14984001"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtains SQL that returns a list of enrolled users that has been filtered by the conditions applied in the availability API, similar to calling get_enrolled_users and then filter_user_list.  <br /></td></tr>
<tr class="separator:ad4b70f9f65e41467111c0d5e14984001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef3b2bb5ddf48b1749d979b54e58bb07" id="r_aef3b2bb5ddf48b1749d979b54e58bb07"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef3b2bb5ddf48b1749d979b54e58bb07">is_available</a> (&amp;$information, $grabthelot=false, $userid=0, <a class="el" href="../../d5/d26/classcourse__modinfo.html">course_modinfo</a> $modinfo=null)</td></tr>
<tr class="memdesc:aef3b2bb5ddf48b1749d979b54e58bb07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether this particular item is currently available according to the availability criteria.  <br /></td></tr>
<tr class="separator:aef3b2bb5ddf48b1749d979b54e58bb07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4997613a4572f10dcb7d32fe22117a6" id="r_ac4997613a4572f10dcb7d32fe22117a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac4997613a4572f10dcb7d32fe22117a6">is_available_for_all</a> ()</td></tr>
<tr class="memdesc:ac4997613a4572f10dcb7d32fe22117a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether this activity is going to be available for all users.  <br /></td></tr>
<tr class="separator:ac4997613a4572f10dcb7d32fe22117a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ce45a510490cbf62bf989c31ab2e990" id="r_a5ce45a510490cbf62bf989c31ab2e990"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ce45a510490cbf62bf989c31ab2e990">update_after_restore</a> ($restoreid, $courseid, <a class="el" href="../../df/d3c/classbase__logger.html">base_logger</a> $logger, $dateoffset, <a class="el" href="../../d2/de0/classbase__task.html">base_task</a> $task)</td></tr>
<tr class="memdesc:a5ce45a510490cbf62bf989c31ab2e990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called during restore (near end of restore).  <br /></td></tr>
<tr class="separator:a5ce45a510490cbf62bf989c31ab2e990"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a0a2e4f5111de1e3cca70aacffe5393c6" id="r_a0a2e4f5111de1e3cca70aacffe5393c6"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a2e4f5111de1e3cca70aacffe5393c6">add_legacy_availability_condition</a> ($availability, $rec, $show)</td></tr>
<tr class="memdesc:a0a2e4f5111de1e3cca70aacffe5393c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a condition from the legacy availability condition.  <br /></td></tr>
<tr class="separator:a0a2e4f5111de1e3cca70aacffe5393c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2a1d491174fdd50a09891d5f41bae19" id="r_af2a1d491174fdd50a09891d5f41bae19"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2a1d491174fdd50a09891d5f41bae19">add_legacy_availability_field_condition</a> ($availability, $rec, $show)</td></tr>
<tr class="memdesc:af2a1d491174fdd50a09891d5f41bae19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a condition from the legacy availability field condition.  <br /></td></tr>
<tr class="separator:af2a1d491174fdd50a09891d5f41bae19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52390ae25b4fcf2d16d6131991ce6d1b" id="r_a52390ae25b4fcf2d16d6131991ce6d1b"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a52390ae25b4fcf2d16d6131991ce6d1b">completion_value_used</a> ($course, $cmid)</td></tr>
<tr class="memdesc:a52390ae25b4fcf2d16d6131991ce6d1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used in course/lib.php because we need to disable the completion tickbox JS (using the non-JS version instead, which causes a page reload) if a completion tickbox value may affect a conditional activity.  <br /></td></tr>
<tr class="separator:a52390ae25b4fcf2d16d6131991ce6d1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70b2c25d1df017e0614abb8fc5818d18" id="r_a70b2c25d1df017e0614abb8fc5818d18"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a70b2c25d1df017e0614abb8fc5818d18">convert_legacy_fields</a> ($rec, $section, $modgroupmembersonlyignored=false)</td></tr>
<tr class="memdesc:a70b2c25d1df017e0614abb8fc5818d18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts legacy data from fields (if provided) into the new availability syntax.  <br /></td></tr>
<tr class="separator:a70b2c25d1df017e0614abb8fc5818d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89fb4badcdecd64e4730d969d9ae9cf4" id="r_a89fb4badcdecd64e4730d969d9ae9cf4"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a89fb4badcdecd64e4730d969d9ae9cf4">format_info</a> ($inforenderable, $courseorid)</td></tr>
<tr class="memdesc:a89fb4badcdecd64e4730d969d9ae9cf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Formats the $cm-&gt;availableinfo string for display.  <br /></td></tr>
<tr class="separator:a89fb4badcdecd64e4730d969d9ae9cf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7bf990053eaeef80fa5c99c5f2c4644" id="r_ae7bf990053eaeef80fa5c99c5f2c4644"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7bf990053eaeef80fa5c99c5f2c4644">get_restore_date_offset</a> ($restoreid)</td></tr>
<tr class="memdesc:ae7bf990053eaeef80fa5c99c5f2c4644"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the date offset (amount by which any date values should be adjusted) for the current restore.  <br /></td></tr>
<tr class="separator:ae7bf990053eaeef80fa5c99c5f2c4644"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad254f4ee40652211fe822acc7d998875" id="r_ad254f4ee40652211fe822acc7d998875"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad254f4ee40652211fe822acc7d998875">get_restore_task</a> ($restoreid)</td></tr>
<tr class="memdesc:ad254f4ee40652211fe822acc7d998875"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the restore task (specifically, the task that calls the update_after_restore method) for the current restore.  <br /></td></tr>
<tr class="separator:ad254f4ee40652211fe822acc7d998875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab53130d2ad62964b1f8154befeaa404c" id="r_ab53130d2ad62964b1f8154befeaa404c"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab53130d2ad62964b1f8154befeaa404c">update_dependency_id_across_course</a> ( $courseorid, $table, $oldid, $newid)</td></tr>
<tr class="memdesc:ab53130d2ad62964b1f8154befeaa404c"><td class="mdescLeft">&#160;</td><td class="mdescRight">In rare cases the system may want to change all references to one ID (e.g.  <br /></td></tr>
<tr class="separator:ab53130d2ad62964b1f8154befeaa404c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a9459516297bb3f675a902011f3e7b6fc" id="r_a9459516297bb3f675a902011f3e7b6fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9459516297bb3f675a902011f3e7b6fc">decode_availability</a> ($availability, $lax)</td></tr>
<tr class="memdesc:a9459516297bb3f675a902011f3e7b6fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decodes availability data from JSON format.  <br /></td></tr>
<tr class="separator:a9459516297bb3f675a902011f3e7b6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d91eb04bec0bd906965768ef5e0b7e6" id="r_a3d91eb04bec0bd906965768ef5e0b7e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3d91eb04bec0bd906965768ef5e0b7e6">get_thing_name</a> ()</td></tr>
<tr class="memdesc:a3d91eb04bec0bd906965768ef5e0b7e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtains the name of the item (<a class="el" href="../../df/db9/classcm__info.html">cm_info</a> or <a class="el" href="../../d1/db5/classsection__info.html">section_info</a>, at present) that this is controlling availability of.  <br /></td></tr>
<tr class="separator:a3d91eb04bec0bd906965768ef5e0b7e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af86d29e95b0732575cab3b2d799db919" id="r_af86d29e95b0732575cab3b2d799db919"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af86d29e95b0732575cab3b2d799db919">get_view_hidden_capability</a> ()</td></tr>
<tr class="memdesc:af86d29e95b0732575cab3b2d799db919"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the capability used to view hidden activities/sections (as appropriate).  <br /></td></tr>
<tr class="separator:af86d29e95b0732575cab3b2d799db919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d878183131dc1c1f29da7e0e9b6613" id="r_ab5d878183131dc1c1f29da7e0e9b6613"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab5d878183131dc1c1f29da7e0e9b6613">set_in_database</a> ($availabilty)</td></tr>
<tr class="memdesc:ab5d878183131dc1c1f29da7e0e9b6613"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores an updated availability tree JSON structure into the relevant database table.  <br /></td></tr>
<tr class="separator:ab5d878183131dc1c1f29da7e0e9b6613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabfca9f0fbe8bd713f7a1eb808c14f3d" id="r_aabfca9f0fbe8bd713f7a1eb808c14f3d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aabfca9f0fbe8bd713f7a1eb808c14f3d">update_dependency_id</a> ($table, $oldid, $newid)</td></tr>
<tr class="memdesc:aabfca9f0fbe8bd713f7a1eb808c14f3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called on a single item.  <br /></td></tr>
<tr class="separator:aabfca9f0fbe8bd713f7a1eb808c14f3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83f74ac813d130b2b0f346456bccb3a5" id="r_a83f74ac813d130b2b0f346456bccb3a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83f74ac813d130b2b0f346456bccb3a5">warn_about_invalid_availability</a> (\<a class="el" href="../../da/d34/classcoding__exception.html">coding_exception</a> $e)</td></tr>
<tr class="memdesc:a83f74ac813d130b2b0f346456bccb3a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">In some places we catch <a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a> because if a bug happens, it would be fatal for the course page GUI; instead we just show a developer debug message.  <br /></td></tr>
<tr class="separator:a83f74ac813d130b2b0f346456bccb3a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:ac0a1c8a84abfdd9df20a15e80f0716d0" id="r_ac0a1c8a84abfdd9df20a15e80f0716d0"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac0a1c8a84abfdd9df20a15e80f0716d0">add_legacy_condition</a> ($availability, $<a class="el" href="../../d0/db0/classcore__availability_1_1condition.html">condition</a>, $show)</td></tr>
<tr class="memdesc:ac0a1c8a84abfdd9df20a15e80f0716d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a condition to an AND group.  <br /></td></tr>
<tr class="separator:ac0a1c8a84abfdd9df20a15e80f0716d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a4cc6f9a07374f9f05ce8f41bcc806236" id="r_a4cc6f9a07374f9f05ce8f41bcc806236"><td class="memItemLeft" align="right" valign="top"><a id="a4cc6f9a07374f9f05ce8f41bcc806236" name="a4cc6f9a07374f9f05ce8f41bcc806236"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>$availability</b></td></tr>
<tr class="memdesc:a4cc6f9a07374f9f05ce8f41bcc806236"><td class="mdescLeft">&#160;</td><td class="mdescRight">Availability data as JSON string. <br /></td></tr>
<tr class="separator:a4cc6f9a07374f9f05ce8f41bcc806236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76cd56e8bd42c3da69b4a0bf678f3371" id="r_a76cd56e8bd42c3da69b4a0bf678f3371"><td class="memItemLeft" align="right" valign="top"><a id="a76cd56e8bd42c3da69b4a0bf678f3371" name="a76cd56e8bd42c3da69b4a0bf678f3371"></a>
<a class="el" href="../../dc/dca/classcore__availability_1_1tree.html">tree</a>&#160;</td><td class="memItemRight" valign="bottom"><b>$availabilitytree</b></td></tr>
<tr class="memdesc:a76cd56e8bd42c3da69b4a0bf678f3371"><td class="mdescLeft">&#160;</td><td class="mdescRight">Availability configuration, decoded from JSON; null if unset. <br /></td></tr>
<tr class="separator:a76cd56e8bd42c3da69b4a0bf678f3371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69bbafd08f4ec337ba709ec9268b65aa" id="r_a69bbafd08f4ec337ba709ec9268b65aa"><td class="memItemLeft" align="right" valign="top"><a id="a69bbafd08f4ec337ba709ec9268b65aa" name="a69bbafd08f4ec337ba709ec9268b65aa"></a>
stdClass&#160;</td><td class="memItemRight" valign="bottom"><b>$course</b></td></tr>
<tr class="memdesc:a69bbafd08f4ec337ba709ec9268b65aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Course. <br /></td></tr>
<tr class="separator:a69bbafd08f4ec337ba709ec9268b65aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ddc3c16e9126fe41caa362d581b35b" id="r_a28ddc3c16e9126fe41caa362d581b35b"><td class="memItemLeft" align="right" valign="top"><a id="a28ddc3c16e9126fe41caa362d581b35b" name="a28ddc3c16e9126fe41caa362d581b35b"></a>
array&#160;</td><td class="memItemRight" valign="bottom"><b>$groups</b></td></tr>
<tr class="memdesc:a28ddc3c16e9126fe41caa362d581b35b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The groups the current user belongs to. <br /></td></tr>
<tr class="separator:a28ddc3c16e9126fe41caa362d581b35b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a382e99ea8042cd9b260b3951b5380b0d" id="r_a382e99ea8042cd9b260b3951b5380b0d"><td class="memItemLeft" align="right" valign="top"><a id="a382e99ea8042cd9b260b3951b5380b0d" name="a382e99ea8042cd9b260b3951b5380b0d"></a>
<a class="el" href="../../d5/d26/classcourse__modinfo.html">course_modinfo</a>&#160;</td><td class="memItemRight" valign="bottom"><b>$modinfo</b> = null</td></tr>
<tr class="memdesc:a382e99ea8042cd9b260b3951b5380b0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modinfo (available only during some functions) <br /></td></tr>
<tr class="separator:a382e99ea8042cd9b260b3951b5380b0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35026ab7468b60467a8ea8fdfd555fcc" id="r_a35026ab7468b60467a8ea8fdfd555fcc"><td class="memItemLeft" align="right" valign="top"><a id="a35026ab7468b60467a8ea8fdfd555fcc" name="a35026ab7468b60467a8ea8fdfd555fcc"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>$visible</b></td></tr>
<tr class="memdesc:a35026ab7468b60467a8ea8fdfd555fcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Visibility flag (eye icon) <br /></td></tr>
<tr class="separator:a35026ab7468b60467a8ea8fdfd555fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-attribs" name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a71bcc7d74b39f8faf042d92551246cad" id="r_a71bcc7d74b39f8faf042d92551246cad"><td class="memItemLeft" align="right" valign="top"><a id="a71bcc7d74b39f8faf042d92551246cad" name="a71bcc7d74b39f8faf042d92551246cad"></a>
static array null&#160;</td><td class="memItemRight" valign="bottom"><b>$restoreinfo</b> = null</td></tr>
<tr class="memdesc:a71bcc7d74b39f8faf042d92551246cad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of information about current restore if any. <br /></td></tr>
<tr class="separator:a71bcc7d74b39f8faf042d92551246cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="../../d9/da0/interface_base.html" title="Base for cache objects.">Base</a> class for conditional availability information (for module or section). </p>
<dl class="section copyright"><dt>Copyright</dt><dd>2014 The Open University </dd></dl>
<dl class="section user"><dt>License</dt><dd><a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> GNU GPL v3 or later </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a0eac6366729c12a6dce98384718cdc2b" name="a0eac6366729c12a6dce98384718cdc2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0eac6366729c12a6dce98384718cdc2b">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::__construct </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$course</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$visible</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$availability</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs with item details. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$course</td><td>Course object </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$visible</td><td>Value of visible flag (eye icon) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$availability</td><td>Availability definition (JSON format) or null </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a></td><td>If data is not valid JSON format </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0a2e4f5111de1e3cca70aacffe5393c6" name="a0a2e4f5111de1e3cca70aacffe5393c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a2e4f5111de1e3cca70aacffe5393c6">&#9670;&#160;</a></span>add_legacy_availability_condition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static core_availability\info::add_legacy_availability_condition </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$availability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rec</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$show</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a condition from the legacy availability condition. </p>
<p>(For use during restore only.)</p>
<p>This function assumes that the activity either has no conditions, or that it has an AND tree with one or more conditions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$availability</td><td>Current availability conditions </td></tr>
    <tr><td class="paramtype">stdClass</td><td class="paramname">$rec</td><td>Object containing information from old table </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$show</td><td>True if 'show' option should be enabled </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>New availability conditions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af2a1d491174fdd50a09891d5f41bae19" name="af2a1d491174fdd50a09891d5f41bae19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a1d491174fdd50a09891d5f41bae19">&#9670;&#160;</a></span>add_legacy_availability_field_condition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static core_availability\info::add_legacy_availability_field_condition </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$availability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rec</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$show</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a condition from the legacy availability field condition. </p>
<p>(For use during restore only.)</p>
<p>This function assumes that the activity either has no conditions, or that it has an AND tree with one or more conditions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$availability</td><td>Current availability conditions </td></tr>
    <tr><td class="paramtype">stdClass</td><td class="paramname">$rec</td><td>Object containing information from old table </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$show</td><td>True if 'show' option should be enabled </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>New availability conditions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac0a1c8a84abfdd9df20a15e80f0716d0" name="ac0a1c8a84abfdd9df20a15e80f0716d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0a1c8a84abfdd9df20a15e80f0716d0">&#9670;&#160;</a></span>add_legacy_condition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static core_availability\info::add_legacy_condition </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$availability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$condition</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$show</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a condition to an AND group. </p>
<p>(For use during restore only.)</p>
<p>This function assumes that the activity either has no conditions, or that it has only conditions added by this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string&#160;|&#160;null</td><td class="paramname">$availability</td><td>Current availability conditions </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$condition</td><td>Condition text '{...}' </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$show</td><td>True if 'show' option should be enabled </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>New availability conditions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a52390ae25b4fcf2d16d6131991ce6d1b" name="a52390ae25b4fcf2d16d6131991ce6d1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52390ae25b4fcf2d16d6131991ce6d1b">&#9670;&#160;</a></span>completion_value_used()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static core_availability\info::completion_value_used </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$course</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$cmid</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Used in course/lib.php because we need to disable the completion tickbox JS (using the non-JS version instead, which causes a page reload) if a completion tickbox value may affect a conditional activity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$course</td><td><a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> course object </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$cmid</td><td>Course-module id </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>True if this is used in a condition, false otherwise </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a70b2c25d1df017e0614abb8fc5818d18" name="a70b2c25d1df017e0614abb8fc5818d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70b2c25d1df017e0614abb8fc5818d18">&#9670;&#160;</a></span>convert_legacy_fields()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static core_availability\info::convert_legacy_fields </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$rec</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$section</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$modgroupmembersonlyignored</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Converts legacy data from fields (if provided) into the new availability syntax. </p>
<p>Supported fields: availablefrom, availableuntil, showavailability (and groupingid for sections).</p>
<p>It also supports the groupmembersonly field for modules. This part was optional in 2.7 but now always runs (because groupmembersonly has been removed).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$rec</td><td>Object possibly containing legacy fields </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$section</td><td>True if this is a section </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$modgroupmembersonlyignored</td><td>Ignored option, previously used </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string|null</td><td>New availability value or null if none </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9459516297bb3f675a902011f3e7b6fc" name="a9459516297bb3f675a902011f3e7b6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9459516297bb3f675a902011f3e7b6fc">&#9670;&#160;</a></span>decode_availability()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::decode_availability </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$availability</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$lax</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Decodes availability data from JSON format. </p>
<p>This function also validates the retrieved data as follows:</p><ol type="1">
<li>Data that does not meet the API-defined structure causes a <a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a> (this should be impossible unless there is a system bug or somebody manually hacks the database).</li>
<li>Data that meets the structure but cannot be implemented (e.g. reference to missing plugin or to module that doesn't exist) is either silently discarded (if $lax is true) or causes a <a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a> (if $lax is false).</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$availability</td><td>Availability string in JSON format </td></tr>
    <tr><td class="paramtype">boolean</td><td class="paramname">$lax</td><td>If true, throw exceptions only for invalid structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">tree</td><td>Availability tree </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a></td><td>If data is not valid JSON format </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aafc49a6e08c01d79cdbaf31f98fd9cd7" name="aafc49a6e08c01d79cdbaf31f98fd9cd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafc49a6e08c01d79cdbaf31f98fd9cd7">&#9670;&#160;</a></span>filter_user_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::filter_user_list </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$users</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests against a user list. </p>
<p>Users who cannot access the activity due to availability restrictions will be removed from the list.</p>
<p>Note this only includes availability restrictions (those handled within this API) and not other ways of restricting access.</p>
<p>This test ONLY includes conditions which are marked as being applied to user lists. For example, group conditions are included but date conditions are not included.</p>
<p>The function operates reasonably efficiently i.e. should not do per-user database queries. It is however likely to be fairly slow.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$users</td><td>Array of userid =&gt; object </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>Filtered version of input array </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../d6/d6a/classcore__availability_1_1info__module.html#a4217314e0a24fc800ddd3daba721a236">core_availability\info_module</a>.</p>

</div>
</div>
<a id="a89fb4badcdecd64e4730d969d9ae9cf4" name="a89fb4badcdecd64e4730d969d9ae9cf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89fb4badcdecd64e4730d969d9ae9cf4">&#9670;&#160;</a></span>format_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static core_availability\info::format_info </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$inforenderable</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$courseorid</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Formats the $cm-&gt;availableinfo string for display. </p>
<p>This includes filling in the names of any course-modules that might be mentioned. Should be called immediately prior to display, or at least somewhere that we can guarantee does not happen from within building the modinfo object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">renderable&#160;|&#160;string</td><td class="paramname">$inforenderable</td><td>Info string or renderable </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;stdClass</td><td class="paramname">$courseorid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>Correctly formatted info string </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae45efe50551cd888084d081d4bbd586c" name="ae45efe50551cd888084d081d4bbd586c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae45efe50551cd888084d081d4bbd586c">&#9670;&#160;</a></span>get_availability_tree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::get_availability_tree </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the availability tree, decoding it if not already done. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">tree</td><td>Availability tree </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa0c6cf5b658954982b289ce35322aa8e" name="aa0c6cf5b658954982b289ce35322aa8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c6cf5b658954982b289ce35322aa8e">&#9670;&#160;</a></span>get_context()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::get_context </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">abstract</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets context used for checking capabilities for this item. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">context</td><td>Context for this item </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../d6/d6a/classcore__availability_1_1info__module.html#a2423603f4ac159254d78a11321613d57">core_availability\info_module</a>, and <a class="el" href="../../dc/df0/classcore__availability_1_1info__section.html#ae748a1f270d8e6432c208b0a0a1696b6">core_availability\info_section</a>.</p>

</div>
</div>
<a id="a16a40d25e0bf14377f9db1cad7a25bfb" name="a16a40d25e0bf14377f9db1cad7a25bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16a40d25e0bf14377f9db1cad7a25bfb">&#9670;&#160;</a></span>get_course()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::get_course </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtains the course associated with this availability information. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass</td><td><a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> course object </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8209d443cf4ba567b3f48df93cde89e0" name="a8209d443cf4ba567b3f48df93cde89e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8209d443cf4ba567b3f48df93cde89e0">&#9670;&#160;</a></span>get_full_information()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::get_full_information </td>
          <td>(</td>
          <td class="paramtype">\<a class="el" href="../../d5/d26/classcourse__modinfo.html">course_modinfo</a></td>          <td class="paramname"><span class="paramname"><em>$modinfo</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtains a string describing all availability restrictions (even if they do not apply any more). </p>
<p>Used to display information for staff editing the website.</p>
<p>The modinfo parameter must be specified when it is called from inside get_fast_modinfo, to avoid infinite recursion.</p>
<p>This function displays <a class="el" href="../../d0/de1/group__core.html#ga1fdef564b77d3a23cf15e73c0962bf14" title="Standard Debugging Function.">debugging()</a> messages if the availability information is invalid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d5/d26/classcourse__modinfo.html">course_modinfo</a></td><td class="paramname">$modinfo</td><td>Usually leave as null for default </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>Information string (for admin) about all restrictions on this item </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3bf62ee25f5c25148ef8c18336af8428" name="a3bf62ee25f5c25148ef8c18336af8428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bf62ee25f5c25148ef8c18336af8428">&#9670;&#160;</a></span>get_groups()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::get_groups </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>$groupingid</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns groups that the current user belongs to on the course. </p>
<p>Note: If not already available, this may make a database query.</p>
<p>This will include groups the user is not allowed to see themselves, so check visibility before displaying groups to the user.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$groupingid</td><td>Grouping ID or 0 (default) for all groups </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int[]</td><td>Array of int (group id) =&gt; int (same group id again); empty array if none </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aed37d0a4634c7530377f8982b8ce98e5" name="aed37d0a4634c7530377f8982b8ce98e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed37d0a4634c7530377f8982b8ce98e5">&#9670;&#160;</a></span>get_modinfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::get_modinfo </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtains the modinfo associated with this availability information. </p>
<p>Note: This field is available ONLY for use by conditions when calculating availability or information.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d5/d26/classcourse__modinfo.html">course_modinfo</a></td><td>Modinfo </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a></td><td>If called at incorrect times </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae7bf990053eaeef80fa5c99c5f2c4644" name="ae7bf990053eaeef80fa5c99c5f2c4644"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7bf990053eaeef80fa5c99c5f2c4644">&#9670;&#160;</a></span>get_restore_date_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static core_availability\info::get_restore_date_offset </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$restoreid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the date offset (amount by which any date values should be adjusted) for the current restore. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$restoreid</td><td>Restore identifier </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td><a class="el" href="../../de/db5/class_date.html" title="Date Parser.">Date</a> offset (0 if none) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a></td><td>If not in a restore (or not in that restore) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad254f4ee40652211fe822acc7d998875" name="ad254f4ee40652211fe822acc7d998875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad254f4ee40652211fe822acc7d998875">&#9670;&#160;</a></span>get_restore_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static core_availability\info::get_restore_task </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$restoreid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the restore task (specifically, the task that calls the update_after_restore method) for the current restore. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$restoreid</td><td>Restore identifier </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d2/de0/classbase__task.html" title="Abstract class defining the basis for one execution (backup/restore) task.">base_task</a></td><td>Restore task </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a></td><td>If not in a restore (or not in that restore) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3d91eb04bec0bd906965768ef5e0b7e6" name="a3d91eb04bec0bd906965768ef5e0b7e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d91eb04bec0bd906965768ef5e0b7e6">&#9670;&#160;</a></span>get_thing_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::get_thing_name </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">abstract</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Obtains the name of the item (<a class="el" href="../../df/db9/classcm__info.html">cm_info</a> or <a class="el" href="../../d1/db5/classsection__info.html">section_info</a>, at present) that this is controlling availability of. </p>
<p>Name should be formatted ready for on-screen display.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>Name of item </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../d6/d6a/classcore__availability_1_1info__module.html#a4c38c73cf295cea87888a885ec5d7b92">core_availability\info_module</a>, and <a class="el" href="../../dc/df0/classcore__availability_1_1info__section.html#aec539f979e5a02f41d17c8307cb73bad">core_availability\info_section</a>.</p>

</div>
</div>
<a id="ad4b70f9f65e41467111c0d5e14984001" name="ad4b70f9f65e41467111c0d5e14984001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4b70f9f65e41467111c0d5e14984001">&#9670;&#160;</a></span>get_user_list_sql()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::get_user_list_sql </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$onlyactive</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtains SQL that returns a list of enrolled users that has been filtered by the conditions applied in the availability API, similar to calling get_enrolled_users and then filter_user_list. </p>
<p>As for filter_user_list, this ONLY filters out users with conditions that are marked as applying to user lists. For example, group conditions are included but date conditions are not included.</p>
<p>The returned SQL is a query that returns a list of user IDs. It does not include brackets, so you neeed to add these to make it into a subquery. You would normally use it in an SQL phrase like "WHERE u.id IN ($sql)".</p>
<p>The function returns an array with '' and an empty array, if there are no restrictions on users from these conditions.</p>
<p>The SQL will be complex and may be slow. It uses named parameters (sorry, I know they are annoying, but it was unavoidable here).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$onlyactive</td><td>True if including only active enrolments </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>Array of SQL code (may be empty) and params </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../d6/d6a/classcore__availability_1_1info__module.html#a0d1debfaa482613f4cb8f26b92984dde">core_availability\info_module</a>.</p>

</div>
</div>
<a id="af86d29e95b0732575cab3b2d799db919" name="af86d29e95b0732575cab3b2d799db919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af86d29e95b0732575cab3b2d799db919">&#9670;&#160;</a></span>get_view_hidden_capability()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::get_view_hidden_capability </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">abstract</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the capability used to view hidden activities/sections (as appropriate). </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>Name of capability used to view hidden items of this type </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../d6/d6a/classcore__availability_1_1info__module.html#ab01ea9b6af89ac85621f9c60ef51e7f7">core_availability\info_module</a>, and <a class="el" href="../../dc/df0/classcore__availability_1_1info__section.html#a783306f43e217231b643fa7919d0b2be">core_availability\info_section</a>.</p>

</div>
</div>
<a id="aef3b2bb5ddf48b1749d979b54e58bb07" name="aef3b2bb5ddf48b1749d979b54e58bb07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef3b2bb5ddf48b1749d979b54e58bb07">&#9670;&#160;</a></span>is_available()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::is_available </td>
          <td>(</td>
          <td class="paramtype">&amp;</td>          <td class="paramname"><span class="paramname"><em>$information</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$grabthelot</em><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$userid</em><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d26/classcourse__modinfo.html">course_modinfo</a></td>          <td class="paramname"><span class="paramname"><em>$modinfo</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines whether this particular item is currently available according to the availability criteria. </p>
<ul>
<li>This does not include the 'visible' setting (i.e. this might return true even if visible is false); visible is handled independently.</li>
<li>This does not take account of the viewhiddenactivities capability. That should apply later.</li>
</ul>
<p>Depending on options selected, a description of the restrictions which mean the student can't view it (in HTML format) may be stored in $information. If there is nothing in $information and this function returns false, then the activity should not be displayed at all.</p>
<p>This function displays <a class="el" href="../../d0/de1/group__core.html#ga1fdef564b77d3a23cf15e73c0962bf14" title="Standard Debugging Function.">debugging()</a> messages if the availability information is invalid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$information</td><td>String describing restrictions in HTML format </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$grabthelot</td><td>Performance hint: if true, caches information required for all course-modules, to make the front page and similar pages work more quickly (works only for current user) </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userid</td><td>If set, specifies a different user ID to check availability for </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../d5/d26/classcourse__modinfo.html">course_modinfo</a></td><td class="paramname">$modinfo</td><td>Usually leave as null for default. Specify when calling recursively from inside <a class="el" href="../../d0/de1/group__core.html#ga30c04da283d2e3d9b0acd2eb34b90829" title="Returns reference to full info about modules in course (including visibility).">get_fast_modinfo()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>True if this item is available to the user, false otherwise </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac4997613a4572f10dcb7d32fe22117a6" name="ac4997613a4572f10dcb7d32fe22117a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4997613a4572f10dcb7d32fe22117a6">&#9670;&#160;</a></span>is_available_for_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::is_available_for_all </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether this activity is going to be available for all users. </p>
<p>Normally, if there are any conditions, then it may be hidden depending on the user. However in the case of date conditions there are some conditions which will definitely not result in it being hidden for anyone.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>True if activity is available for all </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab5d878183131dc1c1f29da7e0e9b6613" name="ab5d878183131dc1c1f29da7e0e9b6613"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5d878183131dc1c1f29da7e0e9b6613">&#9670;&#160;</a></span>set_in_database()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::set_in_database </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$availabilty</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">abstract</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores an updated availability tree JSON structure into the relevant database table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$availabilty</td><td>New JSON value </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="../../d6/d6a/classcore__availability_1_1info__module.html#a9952e00163b30c7ee35afab18c29e312">core_availability\info_module</a>, and <a class="el" href="../../dc/df0/classcore__availability_1_1info__section.html#a3fe0be0c23077e2621f2602b226ed113">core_availability\info_section</a>.</p>

</div>
</div>
<a id="a5ce45a510490cbf62bf989c31ab2e990" name="a5ce45a510490cbf62bf989c31ab2e990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ce45a510490cbf62bf989c31ab2e990">&#9670;&#160;</a></span>update_after_restore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::update_after_restore </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$restoreid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$courseid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d3c/classbase__logger.html">base_logger</a></td>          <td class="paramname"><span class="paramname"><em>$logger</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$dateoffset</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/de0/classbase__task.html">base_task</a></td>          <td class="paramname"><span class="paramname"><em>$task</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called during restore (near end of restore). </p>
<p>Updates any necessary ids and writes the updated tree to the database. May output warnings if necessary (e.g. if a course-module cannot be found after restore).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$restoreid</td><td>Restore identifier </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$courseid</td><td>Target course id </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../df/d3c/classbase__logger.html" title="Base abstract class for all the loggers to be used in backup/restore.">base_logger</a></td><td class="paramname">$logger</td><td>Logger for any warnings </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$dateoffset</td><td><a class="el" href="../../de/db5/class_date.html" title="Date Parser.">Date</a> offset to be added to any dates (0 = none) </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../d2/de0/classbase__task.html" title="Abstract class defining the basis for one execution (backup/restore) task.">base_task</a></td><td class="paramname">$task</td><td>Restore task </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aabfca9f0fbe8bd713f7a1eb808c14f3d" name="aabfca9f0fbe8bd713f7a1eb808c14f3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabfca9f0fbe8bd713f7a1eb808c14f3d">&#9670;&#160;</a></span>update_dependency_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::update_dependency_id </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$table</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$oldid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$newid</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called on a single item. </p>
<p>If necessary, updates availability data where it has a dependency on an item with a particular id.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$table</td><td>Table name e.g. 'course_modules' </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$oldid</td><td>Previous ID </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$newid</td><td>New ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>True if it changed, otherwise false </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab53130d2ad62964b1f8154befeaa404c" name="ab53130d2ad62964b1f8154befeaa404c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab53130d2ad62964b1f8154befeaa404c">&#9670;&#160;</a></span>update_dependency_id_across_course()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static core_availability\info::update_dependency_id_across_course </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$courseorid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$table</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$oldid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>$newid</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>In rare cases the system may want to change all references to one ID (e.g. </p>
<p>one course-module ID) to another one, within a course. This function does that for the conditional availability data for all modules and sections on the course.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int&#160;|&#160;stdClass</td><td class="paramname">$courseorid</td><td>Course id or object </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$table</td><td>Table name e.g. 'course_modules' </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$oldid</td><td>Previous ID </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$newid</td><td>New ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>True if anything changed, otherwise false </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a83f74ac813d130b2b0f346456bccb3a5" name="a83f74ac813d130b2b0f346456bccb3a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83f74ac813d130b2b0f346456bccb3a5">&#9670;&#160;</a></span>warn_about_invalid_availability()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">core_availability\info::warn_about_invalid_availability </td>
          <td>(</td>
          <td class="paramtype">\<a class="el" href="../../da/d34/classcoding__exception.html">coding_exception</a></td>          <td class="paramname"><span class="paramname"><em>$e</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>In some places we catch <a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a> because if a bug happens, it would be fatal for the course page GUI; instead we just show a developer debug message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../da/d34/classcoding__exception.html" title="Exception indicating programming error, must be fixed by a programer.">coding_exception</a></td><td class="paramname">$e</td><td><a class="el" href="../../df/d70/class_exception.html" title="General SimplePie exception class.">Exception</a> that occurred </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>availability/classes/<b>info.php</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Apr 28 2024 02:32:45 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
