<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: rating_manager Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.1</span>
   </div>
   <div id="projectbrief">Moodle 4.1.4+ (Build: 20230707) (f29f757f5f9)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../dd/d5e/classrating__manager-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">rating_manager Class Reference<div class="ingroups"><a class="el" href="../../d4/d58/group__core__rating.html">core_rating</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abdab5128415c930e6cac8e40f9932984"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#abdab5128415c930e6cac8e40f9932984">add_rating</a> ($cm, $<a class="el" href="../../da/d04/classcontext.html">context</a>, $component, $ratingarea, $itemid, $scaleid, $userrating, $rateduserid, $aggregationmethod)</td></tr>
<tr class="memdesc:abdab5128415c930e6cac8e40f9932984"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a new rating.  <br /></td></tr>
<tr class="separator:abdab5128415c930e6cac8e40f9932984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d906c599d54fc68fce465529d369c1c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a7d906c599d54fc68fce465529d369c1c">check_rating_is_valid</a> ($params)</td></tr>
<tr class="memdesc:a7d906c599d54fc68fce465529d369c1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates a submitted rating.  <br /></td></tr>
<tr class="separator:a7d906c599d54fc68fce465529d369c1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92cde69d15307acc6d4eebffd3b084f0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/d6e/classmoodle__database.html">moodle_database</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a92cde69d15307acc6d4eebffd3b084f0">delete_ratings</a> ($options)</td></tr>
<tr class="memdesc:a92cde69d15307acc6d4eebffd3b084f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete one or more ratings.  <br /></td></tr>
<tr class="separator:a92cde69d15307acc6d4eebffd3b084f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73ad3a4cf56936a1aa08fb85b177d8bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a73ad3a4cf56936a1aa08fb85b177d8bf">get_aggregate_label</a> ($aggregationmethod)</td></tr>
<tr class="memdesc:a73ad3a4cf56936a1aa08fb85b177d8bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a string that describes the aggregation method that was provided.  <br /></td></tr>
<tr class="separator:a73ad3a4cf56936a1aa08fb85b177d8bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad052d04051137563e699d1f5047afa86"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#ad052d04051137563e699d1f5047afa86">get_aggregate_types</a> ()</td></tr>
<tr class="memdesc:ad052d04051137563e699d1f5047afa86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns array of aggregate types.  <br /></td></tr>
<tr class="separator:ad052d04051137563e699d1f5047afa86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49b313752bcb7be4078429a79b34c740"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a49b313752bcb7be4078429a79b34c740">get_aggregation_method</a> ($aggregate)</td></tr>
<tr class="memdesc:a49b313752bcb7be4078429a79b34c740"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts an aggregation method constant into something that can be included in SQL.  <br /></td></tr>
<tr class="separator:a49b313752bcb7be4078429a79b34c740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a030a07c1c7fc109b5d5fb2b8d3a7e328"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a030a07c1c7fc109b5d5fb2b8d3a7e328">get_all_ratings_for_item</a> ($options)</td></tr>
<tr class="memdesc:a030a07c1c7fc109b5d5fb2b8d3a7e328"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an array of ratings for a given item (forum post, glossary entry etc).  <br /></td></tr>
<tr class="separator:a030a07c1c7fc109b5d5fb2b8d3a7e328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ac9042e6c603d22b6597e3c9777a166"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a5ac9042e6c603d22b6597e3c9777a166">get_component_ratings_since</a> ($<a class="el" href="../../da/d04/classcontext.html">context</a>, $component, $since)</td></tr>
<tr class="memdesc:a5ac9042e6c603d22b6597e3c9777a166"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get ratings created since a given time.  <br /></td></tr>
<tr class="separator:a5ac9042e6c603d22b6597e3c9777a166"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559558a0279d4b84707a4a6a7f1ab67b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a559558a0279d4b84707a4a6a7f1ab67b">get_plugin_permissions_array</a> ($contextid, $component, $ratingarea)</td></tr>
<tr class="memdesc:a559558a0279d4b84707a4a6a7f1ab67b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Looks for a callback like <a class="el" href="../../d7/d5f/group__mod__forum.html#ga5907223516bdb96d269650322da8afc9" title="Return rating related permissions.">forum_rating_permissions()</a> to retrieve permissions from the plugin whose items are being rated.  <br /></td></tr>
<tr class="separator:a559558a0279d4b84707a4a6a7f1ab67b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d5a6d4d5cdd18b53ffe60ece4796391"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a5d5a6d4d5cdd18b53ffe60ece4796391">get_ratings</a> ($options)</td></tr>
<tr class="memdesc:a5d5a6d4d5cdd18b53ffe60ece4796391"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds rating objects to an array of items (forum posts, glossary entries etc).  <br /></td></tr>
<tr class="separator:a5d5a6d4d5cdd18b53ffe60ece4796391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaec1a3423f31b50b7c528b7688836a28"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#aaec1a3423f31b50b7c528b7688836a28">get_user_grades</a> ($options)</td></tr>
<tr class="memdesc:aaec1a3423f31b50b7c528b7688836a28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an array of grades calculated by aggregating item ratings.  <br /></td></tr>
<tr class="separator:aaec1a3423f31b50b7c528b7688836a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18d9eb63c3acf290471215a6609d3948"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a18d9eb63c3acf290471215a6609d3948">initialise_rating_javascript</a> (<a class="el" href="../../dc/ded/classmoodle__page.html">moodle_page</a> $page)</td></tr>
<tr class="memdesc:a18d9eb63c3acf290471215a6609d3948"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises JavaScript to enable AJAX ratings on the provided page.  <br /></td></tr>
<tr class="separator:a18d9eb63c3acf290471215a6609d3948"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a5267d8ddc363fb63cc5e81eba40ff3da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/d6e/classmoodle__database.html">moodle_database</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#a5267d8ddc363fb63cc5e81eba40ff3da">generate_rating_scale_object</a> ($scaleid)</td></tr>
<tr class="memdesc:a5267d8ddc363fb63cc5e81eba40ff3da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a scale object that can be returned.  <br /></td></tr>
<tr class="separator:a5267d8ddc363fb63cc5e81eba40ff3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad65092fde3b6a4b795f96e51e1bbd63c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#ad65092fde3b6a4b795f96e51e1bbd63c">generate_rating_settings_object</a> ($options)</td></tr>
<tr class="memdesc:ad65092fde3b6a4b795f96e51e1bbd63c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a rating settings object based upon the options it is provided.  <br /></td></tr>
<tr class="separator:ad65092fde3b6a4b795f96e51e1bbd63c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae443d783409a85591fb1717599b68abd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d1b/classrating__manager.html#ae443d783409a85591fb1717599b68abd">get_item_time_created</a> ($item)</td></tr>
<tr class="memdesc:ae443d783409a85591fb1717599b68abd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the time the given item was created.  <br /></td></tr>
<tr class="separator:ae443d783409a85591fb1717599b68abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a624331c9e87b8ee0a370fcdb4512f0ec"><td class="memItemLeft" align="right" valign="top"><a id="a624331c9e87b8ee0a370fcdb4512f0ec" name="a624331c9e87b8ee0a370fcdb4512f0ec"></a>
array&#160;</td><td class="memItemRight" valign="bottom"><b>$scales</b> = array()</td></tr>
<tr class="memdesc:a624331c9e87b8ee0a370fcdb4512f0ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">An array of calculated scale options to save us generating them for each request. <br /></td></tr>
<tr class="separator:a624331c9e87b8ee0a370fcdb4512f0ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abdab5128415c930e6cac8e40f9932984" name="abdab5128415c930e6cac8e40f9932984"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdab5128415c930e6cac8e40f9932984">&#9670;&#160;</a></span>add_rating()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::add_rating </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$component</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ratingarea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$itemid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$scaleid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$userrating</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$rateduserid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$aggregationmethod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a new rating. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$cm</td><td>course module object </td></tr>
    <tr><td class="paramtype">stdClass</td><td class="paramname">$context</td><td>context object </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$component</td><td>component name </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$ratingarea</td><td>rating area </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$itemid</td><td>the item id </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$scaleid</td><td>the scale id </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$userrating</td><td>the user rating </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$rateduserid</td><td>the rated user id </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$aggregationmethod</td><td>the aggregation method </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd><a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> 3.2 </dd></dl>

</div>
</div>
<a id="a7d906c599d54fc68fce465529d369c1c" name="a7d906c599d54fc68fce465529d369c1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d906c599d54fc68fce465529d369c1c">&#9670;&#160;</a></span>check_rating_is_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::check_rating_is_valid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates a submitted rating. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$params</td><td>submitted data context =&gt; object the context in which the rated items exists [required] component =&gt; The component the rating belongs to [required] ratingarea =&gt; The ratingarea the rating is associated with [required] itemid =&gt; int the ID of the object being rated [required] scaleid =&gt; int the scale from which the user can select a rating. Used for bounds checking. [required] rating =&gt; int the submitted rating rateduserid =&gt; int the id of the user whose items have been rated. 0 to update all. [required] aggregation =&gt; int the aggregation method to apply when calculating grades ie RATING_AGGREGATE_AVERAGE [optional] </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">boolean</td><td>true if the rating is valid, false if callback not found, throws <a class="el" href="../../d7/d8d/classrating__exception.html">rating_exception</a> if rating is invalid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a92cde69d15307acc6d4eebffd3b084f0" name="a92cde69d15307acc6d4eebffd3b084f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92cde69d15307acc6d4eebffd3b084f0">&#9670;&#160;</a></span>delete_ratings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/d6e/classmoodle__database.html">moodle_database</a> rating_manager::delete_ratings </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete one or more ratings. </p>
<p>Specify either a rating id, an item id or just the context id.</p>
<p>$DB </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$options</td><td>{ contextid =&gt; int the context in which the ratings exist [required] ratingid =&gt; int the id of an individual rating to delete [optional] userid =&gt; int delete the ratings submitted by this user. May be used in conjuction with itemid [optional] itemid =&gt; int delete all ratings attached to this item [optional] component =&gt; string The component to delete ratings from [optional] ratingarea =&gt; string The ratingarea to delete ratings from [optional] } </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5267d8ddc363fb63cc5e81eba40ff3da" name="a5267d8ddc363fb63cc5e81eba40ff3da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5267d8ddc363fb63cc5e81eba40ff3da">&#9670;&#160;</a></span>generate_rating_scale_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/d6e/classmoodle__database.html">moodle_database</a> rating_manager::generate_rating_scale_object </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$scaleid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates a scale object that can be returned. </p>
<p>$DB moodle database object </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$scaleid</td><td>scale-type identifier </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass</td><td>scale for ratings </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad65092fde3b6a4b795f96e51e1bbd63c" name="ad65092fde3b6a4b795f96e51e1bbd63c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad65092fde3b6a4b795f96e51e1bbd63c">&#9670;&#160;</a></span>generate_rating_settings_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::generate_rating_settings_object </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates a rating settings object based upon the options it is provided. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$options</td><td>{ context =&gt; context the context in which the ratings exists [required] component =&gt; string The component the items belong to [required] ratingarea =&gt; string The ratingarea the items belong to [required] aggregate =&gt; int Aggregation method to apply. RATING_AGGREGATE_AVERAGE, RATING_AGGREGATE_MAXIMUM etc [required] scaleid =&gt; int the scale from which the user can select a rating [required] returnurl =&gt; string the url to return the user to after submitting a rating. Null for ajax requests [optional] assesstimestart =&gt; int only allow rating of items created after this timestamp [optional] assesstimefinish =&gt; int only allow rating of items created before this timestamp [optional] plugintype =&gt; string plugin type ie 'mod' Used to find the permissions callback [optional] pluginname =&gt; string plugin name ie 'forum' Used to find the permissions callback [optional] } </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass</td><td>rating settings object </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a73ad3a4cf56936a1aa08fb85b177d8bf" name="a73ad3a4cf56936a1aa08fb85b177d8bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73ad3a4cf56936a1aa08fb85b177d8bf">&#9670;&#160;</a></span>get_aggregate_label()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::get_aggregate_label </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$aggregationmethod</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a string that describes the aggregation method that was provided. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$aggregationmethod</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>describes the aggregation method that was provided </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad052d04051137563e699d1f5047afa86" name="ad052d04051137563e699d1f5047afa86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad052d04051137563e699d1f5047afa86">&#9670;&#160;</a></span>get_aggregate_types()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::get_aggregate_types </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns array of aggregate types. </p>
<p>Used by ratings.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>aggregate types </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a49b313752bcb7be4078429a79b34c740" name="a49b313752bcb7be4078429a79b34c740"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49b313752bcb7be4078429a79b34c740">&#9670;&#160;</a></span>get_aggregation_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::get_aggregation_method </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$aggregate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an aggregation method constant into something that can be included in SQL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$aggregate</td><td>An aggregation constant. For example, RATING_AGGREGATE_AVERAGE. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>an SQL aggregation method </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a030a07c1c7fc109b5d5fb2b8d3a7e328" name="a030a07c1c7fc109b5d5fb2b8d3a7e328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a030a07c1c7fc109b5d5fb2b8d3a7e328">&#9670;&#160;</a></span>get_all_ratings_for_item()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::get_all_ratings_for_item </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an array of ratings for a given item (forum post, glossary entry etc). </p>
<p>This returns all users ratings for a single item</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$options</td><td>{ context =&gt; context the context in which the ratings exists [required] component =&gt; component using ratings ie <a class="el" href="../../d6/dd5/namespacemod__forum.html" title="&#160;">mod_forum</a> [required] ratingarea =&gt; ratingarea to associate this rating with [required] itemid =&gt; int the id of the associated item (forum post, glossary item etc) [required] sort =&gt; string SQL sort by clause [optional] } </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>an array of ratings </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5ac9042e6c603d22b6597e3c9777a166" name="a5ac9042e6c603d22b6597e3c9777a166"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ac9042e6c603d22b6597e3c9777a166">&#9670;&#160;</a></span>get_component_ratings_since()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::get_component_ratings_since </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$component</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$since</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get ratings created since a given time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$context</td><td>context object </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$component</td><td>component name </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$since</td><td>the time to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>list of ratings db records since the given timelimit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd><a class="el" href="../../d7/d79/namespace_moodle.html" title="&#160;">Moodle</a> 3.2 </dd></dl>

</div>
</div>
<a id="ae443d783409a85591fb1717599b68abd" name="ae443d783409a85591fb1717599b68abd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae443d783409a85591fb1717599b68abd">&#9670;&#160;</a></span>get_item_time_created()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::get_item_time_created </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$item</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the time the given item was created. </p>
<p>TODO: <a href="https://tracker.moodle.org/browse/MDL-31511" class="el">MDL-31511</a> - Find a better solution for this, its not ideal to test for fields really we should be asking the component the item belongs to what field to look for or even the value we are looking for.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$item</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int|null</td><td>return null if the created time is unavailable, otherwise return a timestamp </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a559558a0279d4b84707a4a6a7f1ab67b" name="a559558a0279d4b84707a4a6a7f1ab67b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a559558a0279d4b84707a4a6a7f1ab67b">&#9670;&#160;</a></span>get_plugin_permissions_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::get_plugin_permissions_array </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$contextid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$component</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$ratingarea</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Looks for a callback like <a class="el" href="../../d7/d5f/group__mod__forum.html#ga5907223516bdb96d269650322da8afc9" title="Return rating related permissions.">forum_rating_permissions()</a> to retrieve permissions from the plugin whose items are being rated. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$contextid</td><td>The current context id </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$component</td><td>the name of the component that is using ratings ie '<a class="el" href="../../d6/dd5/namespacemod__forum.html" title="&#160;">mod_forum</a>' </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$ratingarea</td><td>The area the rating is associated with </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>rating related permissions </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5d5a6d4d5cdd18b53ffe60ece4796391" name="a5d5a6d4d5cdd18b53ffe60ece4796391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d5a6d4d5cdd18b53ffe60ece4796391">&#9670;&#160;</a></span>get_ratings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::get_ratings </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds rating objects to an array of items (forum posts, glossary entries etc). </p>
<p>Rating objects are available at $item-&gt;rating</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$options</td><td>{ context =&gt; context the context in which the ratings exists [required] component =&gt; the component name ie <a class="el" href="../../d6/dd5/namespacemod__forum.html" title="&#160;">mod_forum</a> [required] ratingarea =&gt; the ratingarea we are interested in [required] items =&gt; array items like forum posts or glossary items. Each item needs an 'id' ie $items[0]-&gt;id [required] aggregate =&gt; int aggregation method to apply. RATING_AGGREGATE_AVERAGE, RATING_AGGREGATE_MAXIMUM etc [required] scaleid =&gt; int the scale from which the user can select a rating [required] userid =&gt; int the id of the current user [optional] returnurl =&gt; string the url to return the user to after submitting a rating. Null for ajax requests [optional] assesstimestart =&gt; int only allow rating of items created after this timestamp [optional] assesstimefinish =&gt; int only allow rating of items created before this timestamp [optional] </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>the array of items with their ratings attached at $items[0]-&gt;rating </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaec1a3423f31b50b7c528b7688836a28" name="aaec1a3423f31b50b7c528b7688836a28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaec1a3423f31b50b7c528b7688836a28">&#9670;&#160;</a></span>get_user_grades()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::get_user_grades </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an array of grades calculated by aggregating item ratings. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$options</td><td>{ userid =&gt; int the id of the user whose items were rated, NOT the user who submitted ratings. 0 to update all. [required] aggregationmethod =&gt; int the aggregation method to apply when calculating grades ie RATING_AGGREGATE_AVERAGE [required] scaleid =&gt; int the scale from which the user can select a rating. Used for bounds checking. [required] itemtable =&gt; int the table containing the items [required] itemtableusercolum =&gt; int the column of the user table containing the item owner's user id [required] component =&gt; The component for the ratings [required] ratingarea =&gt; The ratingarea for the ratings [required] contextid =&gt; int the context in which the rated items exist [optional] modulename =&gt; string the name of the module [optional] moduleid =&gt; int the id of the module instance [optional] } </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>the array of the user's grades </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a18d9eb63c3acf290471215a6609d3948" name="a18d9eb63c3acf290471215a6609d3948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18d9eb63c3acf290471215a6609d3948">&#9670;&#160;</a></span>initialise_rating_javascript()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rating_manager::initialise_rating_javascript </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/ded/classmoodle__page.html">moodle_page</a>&#160;</td>
          <td class="paramname"><em>$page</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises JavaScript to enable AJAX ratings on the provided page. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../dc/ded/classmoodle__page.html">moodle_page</a></td><td class="paramname">$page</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>always returns true </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>rating/lib.php</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jul 9 2023 03:29:17 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
