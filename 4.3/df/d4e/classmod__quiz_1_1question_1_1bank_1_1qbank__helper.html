<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: mod_quiz\question\bank\qbank_helper Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.3</span>
   </div>
   <div id="projectbrief">Moodle 4.3.4+ (Build: 20240516) (7438fe22897)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../de/da7/namespacemod__quiz.html">mod_quiz</a></li><li class="navelem"><a class="el" href="../../d4/d00/namespacemod__quiz_1_1question.html">question</a></li><li class="navelem"><a class="el" href="../../d6/d00/namespacemod__quiz_1_1question_1_1bank.html">bank</a></li><li class="navelem"><a class="el" href="../../df/d4e/classmod__quiz_1_1question_1_1bank_1_1qbank__helper.html">qbank_helper</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="../../df/d8e/classmod__quiz_1_1question_1_1bank_1_1qbank__helper-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">mod_quiz\question\bank\qbank_helper Class Reference<div class="ingroups"><a class="el" href="../../dd/df0/group__mod__quiz.html">mod_quiz</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a631a8271ce35c6e5e3297fd9020f54c2" id="r_a631a8271ce35c6e5e3297fd9020f54c2"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a631a8271ce35c6e5e3297fd9020f54c2">choose_question_for_redo</a> (int $quizid, context_module $quizcontext, int $slotid, <a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids)</td></tr>
<tr class="memdesc:a631a8271ce35c6e5e3297fd9020f54c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Choose question for redo in a particular slot.  <br /></td></tr>
<tr class="separator:a631a8271ce35c6e5e3297fd9020f54c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a543d5a88844aee62cd2e74436ad61fa6" id="r_a543d5a88844aee62cd2e74436ad61fa6"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a543d5a88844aee62cd2e74436ad61fa6">describe_random_question</a> (stdClass $slotdata)</td></tr>
<tr class="memdesc:a543d5a88844aee62cd2e74436ad61fa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a slot from the array returned by get_question_structure, describe the random question it represents.  <br /></td></tr>
<tr class="separator:a543d5a88844aee62cd2e74436ad61fa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee038d24e0380ccb738bbbb4f83fa6ac" id="r_aee038d24e0380ccb738bbbb4f83fa6ac"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee038d24e0380ccb738bbbb4f83fa6ac">get_question_structure</a> (int $quizid, context_module $quizcontext, int $slotid=null)</td></tr>
<tr class="memdesc:aee038d24e0380ccb738bbbb4f83fa6ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the information about which questions should be used to create a quiz attempt.  <br /></td></tr>
<tr class="separator:aee038d24e0380ccb738bbbb4f83fa6ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa776fdb43632bd0ec18b62067f9a0b29" id="r_aa776fdb43632bd0ec18b62067f9a0b29"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa776fdb43632bd0ec18b62067f9a0b29">get_tag_ids_for_slot</a> (stdClass $slotdata)</td></tr>
<tr class="memdesc:aa776fdb43632bd0ec18b62067f9a0b29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get this list of random selection tag ids from one of the slots returned by get_question_structure.  <br /></td></tr>
<tr class="separator:aa776fdb43632bd0ec18b62067f9a0b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a542728ab9e8585bb2fec4a1540001834" id="r_a542728ab9e8585bb2fec4a1540001834"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a542728ab9e8585bb2fec4a1540001834">get_version_information_for_questions_in_attempt</a> (stdClass $attempt, context_module $quizcontext,)</td></tr>
<tr class="memdesc:a542728ab9e8585bb2fec4a1540001834"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check all the questions in an attempt and return information about their versions.  <br /></td></tr>
<tr class="separator:a542728ab9e8585bb2fec4a1540001834"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed977145cb5905f4e3b056bb31e6f811" id="r_aed977145cb5905f4e3b056bb31e6f811"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed977145cb5905f4e3b056bb31e6f811">get_version_options</a> (int $questionid)</td></tr>
<tr class="memdesc:aed977145cb5905f4e3b056bb31e6f811"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the available versions of a question where one of the version has the given question id.  <br /></td></tr>
<tr class="separator:aed977145cb5905f4e3b056bb31e6f811"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a631a8271ce35c6e5e3297fd9020f54c2" name="a631a8271ce35c6e5e3297fd9020f54c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a631a8271ce35c6e5e3297fd9020f54c2">&#9670;&#160;</a></span>choose_question_for_redo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static mod_quiz\question\bank\qbank_helper::choose_question_for_redo </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>$quizid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context_module</td>          <td class="paramname"><span class="paramname"><em>$quizcontext</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>$slotid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Choose question for redo in a particular slot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$quizid</td><td>the id of the quiz to load the data for. </td></tr>
    <tr><td class="paramtype">context_module</td><td class="paramname">$quizcontext</td><td>the context of this quiz. </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$slotid</td><td>optional, if passed only load the data for this one slot (if it is in this quiz). </td></tr>
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>attempts to consider when avoiding picking repeats of random questions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>the id of the question to use. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a543d5a88844aee62cd2e74436ad61fa6" name="a543d5a88844aee62cd2e74436ad61fa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a543d5a88844aee62cd2e74436ad61fa6">&#9670;&#160;</a></span>describe_random_question()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static mod_quiz\question\bank\qbank_helper::describe_random_question </td>
          <td>(</td>
          <td class="paramtype">stdClass</td>          <td class="paramname"><span class="paramname"><em>$slotdata</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given a slot from the array returned by get_question_structure, describe the random question it represents. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$slotdata</td><td>one of the array elements returned by get_question_structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td>that can be used to display the random slot. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aee038d24e0380ccb738bbbb4f83fa6ac" name="aee038d24e0380ccb738bbbb4f83fa6ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee038d24e0380ccb738bbbb4f83fa6ac">&#9670;&#160;</a></span>get_question_structure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static mod_quiz\question\bank\qbank_helper::get_question_structure </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>$quizid</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context_module</td>          <td class="paramname"><span class="paramname"><em>$quizcontext</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>$slotid</em><span class="paramdefsep"> = </span><span class="paramdefval">null</span></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the information about which questions should be used to create a quiz attempt. </p>
<p>Each element in the returned array is indexed by slot.slot (slot number) an each object hass:</p><ul>
<li>All the field of the slot table.</li>
<li>contextid for where the question(s) come from.</li>
<li>category id for where the questions come from.</li>
<li>For non-random questions, All the fields of the question table (but id is in questionid). Also question version and question bankentryid.</li>
<li>For random questions, filtercondition, which is also unpacked into category, randomrecurse, randomtags, and note that these also have a -&gt;name set and -&gt;qtype set to 'random'.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$quizid</td><td>the id of the quiz to load the data for. </td></tr>
    <tr><td class="paramtype">context_module</td><td class="paramname">$quizcontext</td><td>the context of this quiz. </td></tr>
    <tr><td class="paramtype">int&#160;|&#160;null</td><td class="paramname">$slotid</td><td>optional, if passed only load the data for this one slot (if it is in this quiz). </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>indexed by slot, with information about the content of each slot. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa776fdb43632bd0ec18b62067f9a0b29" name="aa776fdb43632bd0ec18b62067f9a0b29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa776fdb43632bd0ec18b62067f9a0b29">&#9670;&#160;</a></span>get_tag_ids_for_slot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static mod_quiz\question\bank\qbank_helper::get_tag_ids_for_slot </td>
          <td>(</td>
          <td class="paramtype">stdClass</td>          <td class="paramname"><span class="paramname"><em>$slotdata</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get this list of random selection tag ids from one of the slots returned by get_question_structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$slotdata</td><td>one of the array elements returned by get_question_structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>list of tag ids. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a542728ab9e8585bb2fec4a1540001834" name="a542728ab9e8585bb2fec4a1540001834"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a542728ab9e8585bb2fec4a1540001834">&#9670;&#160;</a></span>get_version_information_for_questions_in_attempt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static mod_quiz\question\bank\qbank_helper::get_version_information_for_questions_in_attempt </td>
          <td>(</td>
          <td class="paramtype">stdClass</td>          <td class="paramname"><span class="paramname"><em>$attempt</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">context_module</td>          <td class="paramname"><span class="paramname"><em>$quizcontext</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check all the questions in an attempt and return information about their versions. </p>
<p>Once a quiz attempt has been started, it continues to use the version of each question it was started with. This checks the version used for each question, against the quiz settings for that slot, and returns which version would be used if the quiz attempt was being started now.</p>
<p>There are several cases for each slot:</p><ul>
<li>If this slot is currently set to use version 'Always latest' (which includes random slots) and if there is now a newer version than the one in the attempt, use that.</li>
<li>If the slot is currently set to use a fixed version of the question, and that is different from the version currently in the attempt, use that.</li>
<li>Otherwise, use the same version.</li>
</ul>
<p>This is used in places like the re-grade code.</p>
<p>The returned data probably contains a bit more information than is strictly needed, (see the SQL for details) but returning a few extra ints is fast, and this could prove invaluable when debugging. The key information is probably:</p><ul>
<li>questionattemptslot &lt;&ndash; array key</li>
<li>questionattemptid</li>
<li>currentversion</li>
<li>currentquestionid</li>
<li>newversion</li>
<li>newquestionid</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass</td><td class="paramname">$attempt</td><td>a quiz_attempt database row. </td></tr>
    <tr><td class="paramtype">context_module</td><td class="paramname">$quizcontext</td><td>the quiz context for the quiz the attempt belongs to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">array</td><td>for each <a class="el" href="../../d3/dda/classquestion__attempt.html" title="Tracks an attempt at one particular question in a question_usage_by_activity.">question_attempt</a> in the quiz attempt, information about whether it is using the latest version of the question. Array indexed by questionattemptslot. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aed977145cb5905f4e3b056bb31e6f811" name="aed977145cb5905f4e3b056bb31e6f811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed977145cb5905f4e3b056bb31e6f811">&#9670;&#160;</a></span>get_version_options()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static mod_quiz\question\bank\qbank_helper::get_version_options </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>$questionid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the available versions of a question where one of the version has the given question id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$questionid</td><td>id of a question. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass[]</td><td>other versions of this question. Each object has fields versionid, version and questionid. Array is returned most recent version first. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>mod/quiz/classes/question/bank/<b>qbank_helper.php</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 19 2024 02:40:23 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
