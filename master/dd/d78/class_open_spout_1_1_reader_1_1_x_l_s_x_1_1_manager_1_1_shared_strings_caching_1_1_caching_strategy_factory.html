<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: OpenSpout\Reader\XLSX\Manager\SharedStringsCaching\CachingStrategyFactory Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.2</span>
   </div>
   <div id="projectbrief">Moodle 4.2dev (Build: 20230210) (1ea152c99a6)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>OpenSpout</b></li><li class="navelem"><a class="el" href="../../dd/da5/namespace_open_spout_1_1_reader.html">Reader</a></li><li class="navelem"><a class="el" href="../../d6/d69/namespace_open_spout_1_1_reader_1_1_x_l_s_x.html">XLSX</a></li><li class="navelem"><a class="el" href="../../d7/dfe/namespace_open_spout_1_1_reader_1_1_x_l_s_x_1_1_manager.html">Manager</a></li><li class="navelem"><a class="el" href="../../d9/d45/namespace_open_spout_1_1_reader_1_1_x_l_s_x_1_1_manager_1_1_shared_strings_caching.html">SharedStringsCaching</a></li><li class="navelem"><a class="el" href="../../dd/d78/class_open_spout_1_1_reader_1_1_x_l_s_x_1_1_manager_1_1_shared_strings_caching_1_1_caching_strategy_factory.html">CachingStrategyFactory</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="../../d9/d8f/class_open_spout_1_1_reader_1_1_x_l_s_x_1_1_manager_1_1_shared_strings_caching_1_1_caching_strategy_factory-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">OpenSpout\Reader\XLSX\Manager\SharedStringsCaching\CachingStrategyFactory Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8441c369025c7473403ece4b2288df6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d78/class_open_spout_1_1_reader_1_1_x_l_s_x_1_1_manager_1_1_shared_strings_caching_1_1_caching_strategy_factory.html#a8441c369025c7473403ece4b2288df6b">createBestCachingStrategy</a> ($sharedStringsUniqueCount, $tempFolder, $helperFactory)</td></tr>
<tr class="memdesc:a8441c369025c7473403ece4b2288df6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the best caching strategy, given the number of unique shared strings and the amount of memory available.  <br /></td></tr>
<tr class="separator:a8441c369025c7473403ece4b2288df6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:acbc0e4b0f57742645bd9d55af9aee309"><td class="memItemLeft" align="right" valign="top"><a id="acbc0e4b0f57742645bd9d55af9aee309" name="acbc0e4b0f57742645bd9d55af9aee309"></a>
const&#160;</td><td class="memItemRight" valign="bottom"><b>AMOUNT_MEMORY_NEEDED_PER_STRING_IN_KB</b> = 12</td></tr>
<tr class="separator:acbc0e4b0f57742645bd9d55af9aee309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78c2822c66822380192110015c4830cf"><td class="memItemLeft" align="right" valign="top">const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d78/class_open_spout_1_1_reader_1_1_x_l_s_x_1_1_manager_1_1_shared_strings_caching_1_1_caching_strategy_factory.html#a78c2822c66822380192110015c4830cf">MAX_NUM_STRINGS_PER_TEMP_FILE</a> = 10000</td></tr>
<tr class="memdesc:a78c2822c66822380192110015c4830cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">To avoid running out of memory when extracting a huge number of shared strings, they can be saved to temporary files instead of in memory.  <br /></td></tr>
<tr class="separator:a78c2822c66822380192110015c4830cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a6144bb77314dad2d2d98463fa718bb21"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d78/class_open_spout_1_1_reader_1_1_x_l_s_x_1_1_manager_1_1_shared_strings_caching_1_1_caching_strategy_factory.html#a6144bb77314dad2d2d98463fa718bb21">getMemoryLimitFromIni</a> ()</td></tr>
<tr class="memdesc:a6144bb77314dad2d2d98463fa718bb21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the formatted "memory_limit" value.  <br /></td></tr>
<tr class="separator:a6144bb77314dad2d2d98463fa718bb21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbce76f246a98de978a0eef113f6ab48"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d78/class_open_spout_1_1_reader_1_1_x_l_s_x_1_1_manager_1_1_shared_strings_caching_1_1_caching_strategy_factory.html#afbce76f246a98de978a0eef113f6ab48">getMemoryLimitInKB</a> ()</td></tr>
<tr class="memdesc:afbce76f246a98de978a0eef113f6ab48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the PHP "memory_limit" in Kilobytes.  <br /></td></tr>
<tr class="separator:afbce76f246a98de978a0eef113f6ab48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c3c24eac1aacc4ad00d3485590babc2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d78/class_open_spout_1_1_reader_1_1_x_l_s_x_1_1_manager_1_1_shared_strings_caching_1_1_caching_strategy_factory.html#a7c3c24eac1aacc4ad00d3485590babc2">isInMemoryStrategyUsageSafe</a> ($sharedStringsUniqueCount)</td></tr>
<tr class="memdesc:a7c3c24eac1aacc4ad00d3485590babc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether it is safe to use in-memory caching, given the number of unique shared strings and the amount of memory available.  <br /></td></tr>
<tr class="separator:a7c3c24eac1aacc4ad00d3485590babc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8441c369025c7473403ece4b2288df6b" name="a8441c369025c7473403ece4b2288df6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8441c369025c7473403ece4b2288df6b">&#9670;&#160;</a></span>createBestCachingStrategy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OpenSpout\Reader\XLSX\Manager\SharedStringsCaching\CachingStrategyFactory::createBestCachingStrategy </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sharedStringsUniqueCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tempFolder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$helperFactory</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the best caching strategy, given the number of unique shared strings and the amount of memory available. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">null&#160;|&#160;int</td><td class="paramname">$sharedStringsUniqueCount</td><td>Number of unique shared strings (NULL if unknown) </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$tempFolder</td><td>Temporary folder where the temporary files to store shared strings will be stored </td></tr>
    <tr><td class="paramtype">HelperFactory</td><td class="paramname">$helperFactory</td><td>Factory to create helpers</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">CachingStrategyInterface</td><td>The best caching strategy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6144bb77314dad2d2d98463fa718bb21" name="a6144bb77314dad2d2d98463fa718bb21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6144bb77314dad2d2d98463fa718bb21">&#9670;&#160;</a></span>getMemoryLimitFromIni()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">OpenSpout\Reader\XLSX\Manager\SharedStringsCaching\CachingStrategyFactory::getMemoryLimitFromIni </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the formatted "memory_limit" value. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">string</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afbce76f246a98de978a0eef113f6ab48" name="afbce76f246a98de978a0eef113f6ab48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbce76f246a98de978a0eef113f6ab48">&#9670;&#160;</a></span>getMemoryLimitInKB()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">OpenSpout\Reader\XLSX\Manager\SharedStringsCaching\CachingStrategyFactory::getMemoryLimitInKB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the PHP "memory_limit" in Kilobytes. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">float</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7c3c24eac1aacc4ad00d3485590babc2" name="a7c3c24eac1aacc4ad00d3485590babc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c3c24eac1aacc4ad00d3485590babc2">&#9670;&#160;</a></span>isInMemoryStrategyUsageSafe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">OpenSpout\Reader\XLSX\Manager\SharedStringsCaching\CachingStrategyFactory::isInMemoryStrategyUsageSafe </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sharedStringsUniqueCount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns whether it is safe to use in-memory caching, given the number of unique shared strings and the amount of memory available. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">null&#160;|&#160;int</td><td class="paramname">$sharedStringsUniqueCount</td><td>Number of unique shared strings (NULL if unknown)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a78c2822c66822380192110015c4830cf" name="a78c2822c66822380192110015c4830cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78c2822c66822380192110015c4830cf">&#9670;&#160;</a></span>MAX_NUM_STRINGS_PER_TEMP_FILE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const OpenSpout\Reader\XLSX\Manager\SharedStringsCaching\CachingStrategyFactory::MAX_NUM_STRINGS_PER_TEMP_FILE = 10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To avoid running out of memory when extracting a huge number of shared strings, they can be saved to temporary files instead of in memory. </p>
<p>Then, when accessing a string, the corresponding file contents will be loaded in memory and the string will be quickly retrieved. The performance bottleneck is not when creating these temporary files, but rather when loading their content. Because the contents of the last loaded file stays in memory until another file needs to be loaded, it works best when the indexes of the shared strings are sorted in the sheet data. 10,000 was chosen because it creates small files that are fast to be loaded in memory. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lib/openspout/src/Reader/XLSX/Manager/SharedStringsCaching/CachingStrategyFactory.php</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Feb 12 2023 03:12:36 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
