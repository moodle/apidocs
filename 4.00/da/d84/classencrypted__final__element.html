<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: encrypted_final_element Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.0</span>
   </div>
   <div id="projectbrief">Moodle 4.0.5+ (Build: 20221216) (089260dae2e)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../d3/df0/classencrypted__final__element-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">encrypted_final_element Class Reference<div class="ingroups"><a class="el" href="../../d5/d0a/group__core__backup.html">core_backup</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of <a class="el" href="../../dc/d25/classbackup__final__element.html">backup_final_element</a> that provides symmetric-key AES-256 encryption of contents.  
 <a href="../../da/d84/classencrypted__final__element.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for encrypted_final_element:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../da/d84/classencrypted__final__element.png" usemap="#encrypted_5Ffinal_5Felement_map" alt=""/>
  <map id="encrypted_5Ffinal_5Felement_map" name="encrypted_5Ffinal_5Felement_map">
<area href="../../dc/d25/classbackup__final__element.html" title="Instantiable class representing one final element atom (name/value/parent) piece of information on ba..." alt="backup_final_element" shape="rect" coords="160,112,310,136"/>
<area href="../../d9/dcd/classbase__final__element.html" title="Abstract class representing one final element atom (name/value/parent) piece of information." alt="base_final_element" shape="rect" coords="0,56,150,80"/>
<area href="../../de/da3/interfaceprocessable.html" title="Interface to apply to all the classes we want to be processable by one @base_processor." alt="processable" shape="rect" coords="160,56,310,80"/>
<area href="../../d8/d8e/interfaceannotable.html" title="Interface to apply to all the classes we want to be annotable in the backup/restore process." alt="annotable" shape="rect" coords="320,56,470,80"/>
<area href="../../d1/d3f/classbase__atom.html" title="Abstract class representing one atom (name/value) piece of information." alt="base_atom" shape="rect" coords="0,0,150,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8bcff3c51c9407f17a94a830682bccd0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d84/classencrypted__final__element.html#a8bcff3c51c9407f17a94a830682bccd0">__construct</a> ($name, $attributes=null)</td></tr>
<tr class="memdesc:a8bcff3c51c9407f17a94a830682bccd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor - instantiates a <a class="el" href="../../da/d84/classencrypted__final__element.html" title="Implementation of backup_final_element that provides symmetric-key AES-256 encryption of contents.">encrypted_final_element</a>, specifying its basic info.  <a href="../../da/d84/classencrypted__final__element.html#a8bcff3c51c9407f17a94a830682bccd0">More...</a><br /></td></tr>
<tr class="separator:a8bcff3c51c9407f17a94a830682bccd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7af3cfb8a69ebf1712e28df3eb9d9c11"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcd/classbase__final__element.html#a7af3cfb8a69ebf1712e28df3eb9d9c11">add_attributes</a> ($attributes)</td></tr>
<tr class="separator:a7af3cfb8a69ebf1712e28df3eb9d9c11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade7f21af1ca87d2d97a45509f58708ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d25/classbackup__final__element.html#ade7f21af1ca87d2d97a45509f58708ff">annotate</a> ($backupid)</td></tr>
<tr class="memdesc:ade7f21af1ca87d2d97a45509f58708ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function implements the annotation of the current value associating it with $itemname.  <a href="../../dc/d25/classbackup__final__element.html#ade7f21af1ca87d2d97a45509f58708ff">More...</a><br /></td></tr>
<tr class="separator:ade7f21af1ca87d2d97a45509f58708ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afceedb4adef28cb5b00ee64df1f1e401"><td class="memItemLeft" align="right" valign="top"><a id="afceedb4adef28cb5b00ee64df1f1e401" name="afceedb4adef28cb5b00ee64df1f1e401"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>clean_value</b> ()</td></tr>
<tr class="separator:afceedb4adef28cb5b00ee64df1f1e401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e4d50eec20e71dbe6837b8ee2c8d2b4"><td class="memItemLeft" align="right" valign="top"><a id="a0e4d50eec20e71dbe6837b8ee2c8d2b4" name="a0e4d50eec20e71dbe6837b8ee2c8d2b4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>clean_values</b> ()</td></tr>
<tr class="separator:a0e4d50eec20e71dbe6837b8ee2c8d2b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2033939f1438fbdc4333971c8c9328c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcd/classbase__final__element.html#af2033939f1438fbdc4333971c8c9328c">destroy</a> ()</td></tr>
<tr class="memdesc:af2033939f1438fbdc4333971c8c9328c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy all circular references.  <a href="../../d9/dcd/classbase__final__element.html#af2033939f1438fbdc4333971c8c9328c">More...</a><br /></td></tr>
<tr class="separator:af2033939f1438fbdc4333971c8c9328c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd4c5d640c5285a8c53cda1f0249ad91"><td class="memItemLeft" align="right" valign="top"><a id="acd4c5d640c5285a8c53cda1f0249ad91" name="acd4c5d640c5285a8c53cda1f0249ad91"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_attribute</b> ($name)</td></tr>
<tr class="separator:acd4c5d640c5285a8c53cda1f0249ad91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0e27041c76fef51d88d83dd9a3eb202"><td class="memItemLeft" align="right" valign="top"><a id="ad0e27041c76fef51d88d83dd9a3eb202" name="ad0e27041c76fef51d88d83dd9a3eb202"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_attributes</b> ()</td></tr>
<tr class="memdesc:ad0e27041c76fef51d88d83dd9a3eb202"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public API starts here. <br /></td></tr>
<tr class="separator:ad0e27041c76fef51d88d83dd9a3eb202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8abbe171b21ca0f6cc0b33a0c89a201"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcd/classbase__final__element.html#af8abbe171b21ca0f6cc0b33a0c89a201">get_level</a> ()</td></tr>
<tr class="separator:af8abbe171b21ca0f6cc0b33a0c89a201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30aeacc90b874ceef1f579645f551be8"><td class="memItemLeft" align="right" valign="top"><a id="a30aeacc90b874ceef1f579645f551be8" name="a30aeacc90b874ceef1f579645f551be8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_name</b> ()</td></tr>
<tr class="memdesc:a30aeacc90b874ceef1f579645f551be8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public API starts here. <br /></td></tr>
<tr class="separator:a30aeacc90b874ceef1f579645f551be8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a226b8479a13deaadb8e56680cd558681"><td class="memItemLeft" align="right" valign="top"><a id="a226b8479a13deaadb8e56680cd558681" name="a226b8479a13deaadb8e56680cd558681"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_parent</b> ()</td></tr>
<tr class="separator:a226b8479a13deaadb8e56680cd558681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa186e348b230391b04002c04fa7dcc4c"><td class="memItemLeft" align="right" valign="top"><a id="aa186e348b230391b04002c04fa7dcc4c" name="aa186e348b230391b04002c04fa7dcc4c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_value</b> ()</td></tr>
<tr class="separator:aa186e348b230391b04002c04fa7dcc4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0272cfdfa9b3128a3f59ffa9fe108b0e"><td class="memItemLeft" align="right" valign="top"><a id="a0272cfdfa9b3128a3f59ffa9fe108b0e" name="a0272cfdfa9b3128a3f59ffa9fe108b0e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>is_set</b> ()</td></tr>
<tr class="separator:a0272cfdfa9b3128a3f59ffa9fe108b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6545ceb00910cb8c5ba7534f0e26446"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d25/classbackup__final__element.html#af6545ceb00910cb8c5ba7534f0e26446">process</a> ($processor)</td></tr>
<tr class="memdesc:af6545ceb00910cb8c5ba7534f0e26446"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function will call to the corresponding processor method in other to make them perform the desired tasks.  <a href="../../dc/d25/classbackup__final__element.html#af6545ceb00910cb8c5ba7534f0e26446">More...</a><br /></td></tr>
<tr class="separator:af6545ceb00910cb8c5ba7534f0e26446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5f8f3c803c705b9a2871e870e559224"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d25/classbackup__final__element.html#ab5f8f3c803c705b9a2871e870e559224">set_annotation_item</a> ($itemname)</td></tr>
<tr class="memdesc:ab5f8f3c803c705b9a2871e870e559224"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the $itemname to be used when annotating.  <a href="../../dc/d25/classbackup__final__element.html#ab5f8f3c803c705b9a2871e870e559224">More...</a><br /></td></tr>
<tr class="separator:ab5f8f3c803c705b9a2871e870e559224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd41f18e03802072075e550ecd770b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d84/classencrypted__final__element.html#a0dd41f18e03802072075e550ecd770b4">set_value</a> ($<a class="el" href="../../d8/ded/group___simple_pie.html#gaefbfa229f1c9e1fc967bff724a010f9e">value</a>)</td></tr>
<tr class="memdesc:a0dd41f18e03802072075e550ecd770b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the value of the field.  <a href="../../da/d84/classencrypted__final__element.html#a0dd41f18e03802072075e550ecd770b4">More...</a><br /></td></tr>
<tr class="separator:a0dd41f18e03802072075e550ecd770b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23488aabaa8c559f4b8f4f756571c6c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcd/classbase__final__element.html#a23488aabaa8c559f4b8f4f756571c6c4">to_string</a> ($showvalue=false)</td></tr>
<tr class="separator:a23488aabaa8c559f4b8f4f756571c6c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a276fd6f89dcfe2b758913668503ea3da"><td class="memItemLeft" align="right" valign="top"><a id="a276fd6f89dcfe2b758913668503ea3da" name="a276fd6f89dcfe2b758913668503ea3da"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>find_element_by_path</b> ($path)</td></tr>
<tr class="separator:a276fd6f89dcfe2b758913668503ea3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae762e744e75cf43287784700cc113224"><td class="memItemLeft" align="right" valign="top"><a id="ae762e744e75cf43287784700cc113224" name="ae762e744e75cf43287784700cc113224"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>find_first_parent_by_name</b> ($name)</td></tr>
<tr class="separator:ae762e744e75cf43287784700cc113224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bc1a78766eb18959e77a96ebc6a8ac0"><td class="memItemLeft" align="right" valign="top"><a id="a5bc1a78766eb18959e77a96ebc6a8ac0" name="a5bc1a78766eb18959e77a96ebc6a8ac0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_grandoptigroupelement_or_grandparent</b> ()</td></tr>
<tr class="separator:a5bc1a78766eb18959e77a96ebc6a8ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5fccf49f93293ac42172c34a338cecb"><td class="memItemLeft" align="right" valign="top"><a id="ab5fccf49f93293ac42172c34a338cecb" name="ab5fccf49f93293ac42172c34a338cecb"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>get_grandparent</b> ()</td></tr>
<tr class="separator:ab5fccf49f93293ac42172c34a338cecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95968ecbed83df53ca29668977ab0ff5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d25/classbackup__final__element.html#a95968ecbed83df53ca29668977ab0ff5">get_new_attribute</a> ($name)</td></tr>
<tr class="memdesc:a95968ecbed83df53ca29668977ab0ff5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns one instace of the @base_attribute class to work with when attributes are added simply by name.  <a href="../../dc/d25/classbackup__final__element.html#a95968ecbed83df53ca29668977ab0ff5">More...</a><br /></td></tr>
<tr class="separator:a95968ecbed83df53ca29668977ab0ff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f0ccb1e7ac6fd94c9d0f79481c99fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d84/classencrypted__final__element.html#a27f0ccb1e7ac6fd94c9d0f79481c99fa">set_key</a> ($key)</td></tr>
<tr class="memdesc:a27f0ccb1e7ac6fd94c9d0f79481c99fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the encryption key manually, overriding default backup_encryptkey config.  <a href="../../da/d84/classencrypted__final__element.html#a27f0ccb1e7ac6fd94c9d0f79481c99fa">More...</a><br /></td></tr>
<tr class="separator:a27f0ccb1e7ac6fd94c9d0f79481c99fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1663aa16da507a5df671de44c466fde1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dcd/classbase__final__element.html#a1663aa16da507a5df671de44c466fde1">set_parent</a> ($element)</td></tr>
<tr class="separator:a1663aa16da507a5df671de44c466fde1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf825dfe18a47b49afc5b73558f96154"><td class="memItemLeft" align="right" valign="top"><a id="acf825dfe18a47b49afc5b73558f96154" name="acf825dfe18a47b49afc5b73558f96154"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>validate_name</b> ($name)</td></tr>
<tr class="separator:acf825dfe18a47b49afc5b73558f96154"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a27beeb7f9da28402161afe2ad1b57006"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d84/classencrypted__final__element.html#a27beeb7f9da28402161afe2ad1b57006">generate_encryption_random_key</a> ($bytes)</td></tr>
<tr class="memdesc:a27beeb7f9da28402161afe2ad1b57006"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate an appropiate random key to be used for encrypting backup information.  <a href="../../da/d84/classencrypted__final__element.html#a27beeb7f9da28402161afe2ad1b57006">More...</a><br /></td></tr>
<tr class="separator:a27beeb7f9da28402161afe2ad1b57006"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aafa58c5990286d2eebd3f3b4a1cb3fe4"><td class="memItemLeft" align="right" valign="top"><a id="aafa58c5990286d2eebd3f3b4a1cb3fe4" name="aafa58c5990286d2eebd3f3b4a1cb3fe4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>$annotationitem</b></td></tr>
<tr class="separator:aafa58c5990286d2eebd3f3b4a1cb3fe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadfaa4bb474c0fd9098aee9dde0bb60b"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d84/classencrypted__final__element.html#aadfaa4bb474c0fd9098aee9dde0bb60b">$key</a> = null</td></tr>
<tr class="memdesc:aadfaa4bb474c0fd9098aee9dde0bb60b"><td class="mdescLeft">&#160;</td><td class="mdescRight">cypher appropiate raw key for backups in the site.  <a href="../../da/d84/classencrypted__final__element.html#aadfaa4bb474c0fd9098aee9dde0bb60b">More...</a><br /></td></tr>
<tr class="separator:aadfaa4bb474c0fd9098aee9dde0bb60b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Implementation of <a class="el" href="../../dc/d25/classbackup__final__element.html">backup_final_element</a> that provides symmetric-key AES-256 encryption of contents. </p>
<p >This final element transparently encrypts, for secure storage and transport, any content that shouldn't be shown normally in plain text. Usually, passwords or keys that cannot use hashing algorithms, although potentially can encrypt any content. All information is encoded using base64.</p>
<p >Features:</p><ul>
<li>requires openssl extension to work. Without it contents are completely omitted.</li>
<li>automatically creates an appropriate default key for the site and stores it into backup_encryptkey config (bas64 encoded).</li>
<li>uses a different appropriate init vector for every operation, which is transmited with the encrypted contents.</li>
<li>all generated data is base64 encoded for safe transmission.</li>
<li>automatically adds "encrypted" attribute for easier detection.</li>
<li>implements HMAC for providing integrity.</li>
</ul>
<dl class="section copyright"><dt>Copyright</dt><dd>2017 onwards Eloy Lafuente (stronk7) <a href="http://stronk7.com" class="el externalurl"></a> </dd></dl>
<dl class="section user"><dt>License</dt><dd><a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> GNU GPL v3 or later </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8bcff3c51c9407f17a94a830682bccd0" name="a8bcff3c51c9407f17a94a830682bccd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bcff3c51c9407f17a94a830682bccd0">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encrypted_final_element::__construct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$attributes</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor - instantiates a <a class="el" href="../../da/d84/classencrypted__final__element.html" title="Implementation of backup_final_element that provides symmetric-key AES-256 encryption of contents.">encrypted_final_element</a>, specifying its basic info. </p>
<p >Overridden to automatically add the 'encrypted' attribute if missing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>name of the element </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$attributes</td><td>attributes this element will handle (optional, defaults to null) </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="../../d9/dcd/classbase__final__element.html#a3955d8601be404966b04500b9ee6b0ef">base_final_element</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7af3cfb8a69ebf1712e28df3eb9d9c11" name="a7af3cfb8a69ebf1712e28df3eb9d9c11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7af3cfb8a69ebf1712e28df3eb9d9c11">&#9670;&#160;</a></span>add_attributes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">base_final_element::add_attributes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$attributes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="../../d2/ddf/classbackup__optigroup__element.html#a5498257fc3cb9818644007c6f85b7dfc">backup_optigroup_element</a>, and <a class="el" href="../../d2/d92/classbase__optigroup.html#ac2864123131a1eefd7fec14fba8844fc">base_optigroup</a>.</p>

</div>
</div>
<a id="ade7f21af1ca87d2d97a45509f58708ff" name="ade7f21af1ca87d2d97a45509f58708ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade7f21af1ca87d2d97a45509f58708ff">&#9670;&#160;</a></span>annotate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">backup_final_element::annotate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$backupid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function implements the annotation of the current value associating it with $itemname. </p>

<p>Implements <a class="el" href="../../d8/d8e/interfaceannotable.html#a78636739cc6ba4bafc4b220ea53037c5">annotable</a>.</p>

</div>
</div>
<a id="af2033939f1438fbdc4333971c8c9328c" name="af2033939f1438fbdc4333971c8c9328c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2033939f1438fbdc4333971c8c9328c">&#9670;&#160;</a></span>destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">base_final_element::destroy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy all circular references. </p>
<p >It helps PHP 5.2 a lot! </p>

<p>Reimplemented in <a class="el" href="../../dc/def/classbase__nested__element.html#a3e4e74cbe9be46771f3b0ccdb372100e">base_nested_element</a>.</p>

</div>
</div>
<a id="a27beeb7f9da28402161afe2ad1b57006" name="a27beeb7f9da28402161afe2ad1b57006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27beeb7f9da28402161afe2ad1b57006">&#9670;&#160;</a></span>generate_encryption_random_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static encrypted_final_element::generate_encryption_random_key </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$bytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate an appropiate random key to be used for encrypting backup information. </p>
<p >Normally used as site default encryption key (backup_encryptkey config) and also for calculating the init vectors.</p>
<p >Note that until PHP 5.6.12 openssl_random_pseudo_bytes() did NOT use a "cryptographically strong algorithm" <a href="https://bugs.php.net/bug.php?id=70014" class="el externalurl"></a> But it's beyond my crypto-knowledge when it's worth finding a <em>real</em> better alternative.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$bytes</td><td>Number of bytes to determine the key length expected. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af8abbe171b21ca0f6cc0b33a0c89a201" name="af8abbe171b21ca0f6cc0b33a0c89a201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8abbe171b21ca0f6cc0b33a0c89a201">&#9670;&#160;</a></span>get_level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">base_final_element::get_level </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="../../d2/ddf/classbackup__optigroup__element.html#a17cb5141b9dfb19159aaea26fdc2ecd6">backup_optigroup_element</a>, and <a class="el" href="../../d2/d92/classbase__optigroup.html#a8b6d5702699ec75a52be21f4cadeca8b">base_optigroup</a>.</p>

</div>
</div>
<a id="a95968ecbed83df53ca29668977ab0ff5" name="a95968ecbed83df53ca29668977ab0ff5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95968ecbed83df53ca29668977ab0ff5">&#9670;&#160;</a></span>get_new_attribute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">backup_final_element::get_new_attribute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns one instace of the @base_attribute class to work with when attributes are added simply by name. </p>

<p>Reimplemented from <a class="el" href="../../d9/dcd/classbase__final__element.html#abe592512f4f1c909543b01892ab752eb">base_final_element</a>.</p>

</div>
</div>
<a id="af6545ceb00910cb8c5ba7534f0e26446" name="af6545ceb00910cb8c5ba7534f0e26446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6545ceb00910cb8c5ba7534f0e26446">&#9670;&#160;</a></span>process()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">backup_final_element::process </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$processor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function will call to the corresponding processor method in other to make them perform the desired tasks. </p>

<p>Implements <a class="el" href="../../de/da3/interfaceprocessable.html#ab2fbb62437816d681f98945e37e4239c">processable</a>.</p>

</div>
</div>
<a id="ab5f8f3c803c705b9a2871e870e559224" name="ab5f8f3c803c705b9a2871e870e559224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5f8f3c803c705b9a2871e870e559224">&#9670;&#160;</a></span>set_annotation_item()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">backup_final_element::set_annotation_item </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$itemname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function sets the $itemname to be used when annotating. </p>

<p>Implements <a class="el" href="../../d8/d8e/interfaceannotable.html#a30bf795aa50ea920400da14667d27444">annotable</a>.</p>

</div>
</div>
<a id="a27f0ccb1e7ac6fd94c9d0f79481c99fa" name="a27f0ccb1e7ac6fd94c9d0f79481c99fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27f0ccb1e7ac6fd94c9d0f79481c99fa">&#9670;&#160;</a></span>set_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">encrypted_final_element::set_key </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the encryption key manually, overriding default backup_encryptkey config. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$key</td><td>key to be used for encrypting. Required to be 256-bit key. Use a safe generation technique. See self::generate_encryption_random_key() below. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1663aa16da507a5df671de44c466fde1" name="a1663aa16da507a5df671de44c466fde1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1663aa16da507a5df671de44c466fde1">&#9670;&#160;</a></span>set_parent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">base_final_element::set_parent </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$element</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="../../d2/ddf/classbackup__optigroup__element.html#ad71055a2179e856ea69efdf11015d83a">backup_optigroup_element</a>, and <a class="el" href="../../d2/d92/classbase__optigroup.html#a8363e5c60e37da34ba288760699a7f5e">base_optigroup</a>.</p>

</div>
</div>
<a id="a0dd41f18e03802072075e550ecd770b4" name="a0dd41f18e03802072075e550ecd770b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dd41f18e03802072075e550ecd770b4">&#9670;&#160;</a></span>set_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">encrypted_final_element::set_value </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the value of the field. </p>
<p >This method sets the value of the element, encrypted using the specified key for it, defaulting to (and generating) backup_encryptkey config. HMAC is used for integrity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$value</td><td>plain-text content the will be stored encrypted and encoded. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="../../d1/d3f/classbase__atom.html">base_atom</a>.</p>

</div>
</div>
<a id="a23488aabaa8c559f4b8f4f756571c6c4" name="a23488aabaa8c559f4b8f4f756571c6c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23488aabaa8c559f4b8f4f756571c6c4">&#9670;&#160;</a></span>to_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">base_final_element::to_string </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$showvalue</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="../../d1/d3f/classbase__atom.html">base_atom</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aadfaa4bb474c0fd9098aee9dde0bb60b" name="aadfaa4bb474c0fd9098aee9dde0bb60b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadfaa4bb474c0fd9098aee9dde0bb60b">&#9670;&#160;</a></span>$key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string encrypted_final_element::$key = null</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>cypher appropiate raw key for backups in the site. </p>
<p >Defaults to backup_encryptkey config. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>backup/moodle2/backup_custom_fields.php</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Dec 18 2022 02:49:31 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
