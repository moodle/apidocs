<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Moodle PHP Documentation: mod_quiz\grade_calculator Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Moodle PHP Documentation"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-styles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../Moodle-Logo-ReversedWhite_RGB.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Moodle PHP Documentation<span id="projectnumber">&#160;4.4</span>
   </div>
   <div id="projectbrief">Moodle 4.4+ (Build: 20240524) (4e04339cbd5)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search',false);
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../de/da7/namespacemod__quiz.html">mod_quiz</a></li><li class="navelem"><a class="el" href="../../d1/dc7/classmod__quiz_1_1grade__calculator.html">grade_calculator</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../df/d2a/classmod__quiz_1_1grade__calculator-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">mod_quiz\grade_calculator Class Reference<div class="ingroups"><a class="el" href="../../dd/df0/group__mod__quiz.html">mod_quiz</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4531354ba65100bd5adc6ba0693f3942" id="r_a4531354ba65100bd5adc6ba0693f3942"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4531354ba65100bd5adc6ba0693f3942">compute_grade_item_totals</a> (<a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a> $quba)</td></tr>
<tr class="memdesc:a4531354ba65100bd5adc6ba0693f3942"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the grade and maximum for each item, for an attempt where the <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a> is available.  <br /></td></tr>
<tr class="separator:a4531354ba65100bd5adc6ba0693f3942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae69916707f4fddf7c89a1759f190d97a" id="r_ae69916707f4fddf7c89a1759f190d97a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae69916707f4fddf7c89a1759f190d97a">compute_grade_item_totals_for_attempts</a> (array $qubaids)</td></tr>
<tr class="memdesc:ae69916707f4fddf7c89a1759f190d97a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the grade and maximum for each item, for some attempts where we only have the usage ids.  <br /></td></tr>
<tr class="separator:ae69916707f4fddf7c89a1759f190d97a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101ec060f8277b37e34ad85604588a74" id="r_a101ec060f8277b37e34ad85604588a74"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a101ec060f8277b37e34ad85604588a74">get_grade_items</a> ()</td></tr>
<tr class="memdesc:a101ec060f8277b37e34ad85604588a74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the extra grade items for this quiz.  <br /></td></tr>
<tr class="separator:a101ec060f8277b37e34ad85604588a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a589d870dc62bcfbf2b63f04fda247302" id="r_a589d870dc62bcfbf2b63f04fda247302"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a589d870dc62bcfbf2b63f04fda247302">load_grade_item_totals</a> (<a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a> $qubaids)</td></tr>
<tr class="memdesc:a589d870dc62bcfbf2b63f04fda247302"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query the database return the total mark for each grade item for a set of attempts.  <br /></td></tr>
<tr class="separator:a589d870dc62bcfbf2b63f04fda247302"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f1d456ca7ba97c985b7e39af5c6f07" id="r_a31f1d456ca7ba97c985b7e39af5c6f07"><td class="memItemLeft" align="right" valign="top"><a id="a31f1d456ca7ba97c985b7e39af5c6f07" name="a31f1d456ca7ba97c985b7e39af5c6f07"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>recompute_all_attempt_sumgrades</b> ()</td></tr>
<tr class="memdesc:a31f1d456ca7ba97c985b7e39af5c6f07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the sumgrades field of attempts at this quiz. <br /></td></tr>
<tr class="separator:a31f1d456ca7ba97c985b7e39af5c6f07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5246a32ce9ab07ffe15a1cf46185b7b" id="r_ac5246a32ce9ab07ffe15a1cf46185b7b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac5246a32ce9ab07ffe15a1cf46185b7b">recompute_all_final_grades</a> ()</td></tr>
<tr class="memdesc:ac5246a32ce9ab07ffe15a1cf46185b7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the final grade at this quiz for all students.  <br /></td></tr>
<tr class="separator:ac5246a32ce9ab07ffe15a1cf46185b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6132385f6363b5f324ada4eaf9d33cb7" id="r_a6132385f6363b5f324ada4eaf9d33cb7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6132385f6363b5f324ada4eaf9d33cb7">recompute_final_grade</a> (?int $userid=null, array $attempts=[])</td></tr>
<tr class="memdesc:a6132385f6363b5f324ada4eaf9d33cb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the final grade at this quiz for a particular student.  <br /></td></tr>
<tr class="separator:a6132385f6363b5f324ada4eaf9d33cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc437fef90b47cf5c66f62d15c1875d" id="r_acbc437fef90b47cf5c66f62d15c1875d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acbc437fef90b47cf5c66f62d15c1875d">recompute_quiz_sumgrades</a> ()</td></tr>
<tr class="memdesc:acbc437fef90b47cf5c66f62d15c1875d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the sumgrades field of the quiz.  <br /></td></tr>
<tr class="separator:acbc437fef90b47cf5c66f62d15c1875d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad53b744f462cee81885a6efc5da01e4a" id="r_ad53b744f462cee81885a6efc5da01e4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad53b744f462cee81885a6efc5da01e4a">set_slots</a> (array $slots)</td></tr>
<tr class="memdesc:ad53b744f462cee81885a6efc5da01e4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lets other code pass in the slot information, so it does note have to be re-loaded from the <a class="el" href="../../d1/dc8/class_d_b.html" title="The main &quot;DB&quot; class is simply a container class with some static methods for creating DB objects as w...">DB</a>.  <br /></td></tr>
<tr class="separator:ad53b744f462cee81885a6efc5da01e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec3b15686c9e071b175a34bbcb3358f0" id="r_aec3b15686c9e071b175a34bbcb3358f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec3b15686c9e071b175a34bbcb3358f0">update_quiz_maximum_grade</a> (float $newgrade)</td></tr>
<tr class="memdesc:aec3b15686c9e071b175a34bbcb3358f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the quiz setting for the grade the quiz is out of.  <br /></td></tr>
<tr class="separator:aec3b15686c9e071b175a34bbcb3358f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aba4b98c11d46693f4ec45a375b390ff3" id="r_aba4b98c11d46693f4ec45a375b390ff3"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba4b98c11d46693f4ec45a375b390ff3">create</a> (<a class="el" href="../../db/d84/classmod__quiz_1_1quiz__settings.html">quiz_settings</a> $quizobj)</td></tr>
<tr class="memdesc:aba4b98c11d46693f4ec45a375b390ff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factory.  <br /></td></tr>
<tr class="separator:aba4b98c11d46693f4ec45a375b390ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a2884310a823320865e97b53f432323e7" id="r_a2884310a823320865e97b53f432323e7"><td class="memItemLeft" align="right" valign="top">float const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2884310a823320865e97b53f432323e7">ALMOST_ZERO</a> = 0.000005</td></tr>
<tr class="memdesc:a2884310a823320865e97b53f432323e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">a number that is effectively zero.  <br /></td></tr>
<tr class="separator:a2884310a823320865e97b53f432323e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ae7e365543a621606a67ab7cf7a440af2" id="r_ae7e365543a621606a67ab7cf7a440af2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7e365543a621606a67ab7cf7a440af2">__construct</a> (<a class="el" href="../../db/d84/classmod__quiz_1_1quiz__settings.html">quiz_settings</a> $quizobj)</td></tr>
<tr class="memdesc:ae7e365543a621606a67ab7cf7a440af2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:ae7e365543a621606a67ab7cf7a440af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660d1d67afd81d5aee282d4050fb83bc" id="r_a660d1d67afd81d5aee282d4050fb83bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a660d1d67afd81d5aee282d4050fb83bc">compute_final_grade_from_attempts</a> (array $attempts)</td></tr>
<tr class="memdesc:a660d1d67afd81d5aee282d4050fb83bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the overall grade for a quiz given a number of attempts by a particular user.  <br /></td></tr>
<tr class="separator:a660d1d67afd81d5aee282d4050fb83bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d37d78509648bccc616baa6c347913" id="r_ab9d37d78509648bccc616baa6c347913"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab9d37d78509648bccc616baa6c347913">ensure_grade_items_loaded</a> ()</td></tr>
<tr class="memdesc:ab9d37d78509648bccc616baa6c347913"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure the {.  <br /></td></tr>
<tr class="separator:ab9d37d78509648bccc616baa6c347913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab74d7ecb5c284c1f7388bbdd18048e7d" id="r_ab74d7ecb5c284c1f7388bbdd18048e7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab74d7ecb5c284c1f7388bbdd18048e7d">ensure_slots_loaded</a> ()</td></tr>
<tr class="memdesc:ab74d7ecb5c284c1f7388bbdd18048e7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure the {.  <br /></td></tr>
<tr class="separator:ab74d7ecb5c284c1f7388bbdd18048e7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a444904108199ebb3adf782e36dc1fe00" id="r_a444904108199ebb3adf782e36dc1fe00"><td class="memItemLeft" align="right" valign="top">stdClass[] null array&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a444904108199ebb3adf782e36dc1fe00">$gradeitems</a> = null</td></tr>
<tr class="memdesc:a444904108199ebb3adf782e36dc1fe00"><td class="mdescLeft">&#160;</td><td class="mdescRight">quiz_grade_items for this quiz indexed by id, sorted by sortorder, with a maxmark field added.  <br /></td></tr>
<tr class="separator:a444904108199ebb3adf782e36dc1fe00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad79f0f398b852781ef63b46fae4379a4" id="r_ad79f0f398b852781ef63b46fae4379a4"><td class="memItemLeft" align="right" valign="top"><a id="ad79f0f398b852781ef63b46fae4379a4" name="ad79f0f398b852781ef63b46fae4379a4"></a>
<a class="el" href="../../db/d84/classmod__quiz_1_1quiz__settings.html">quiz_settings</a>&#160;</td><td class="memItemRight" valign="bottom"><b>$quizobj</b></td></tr>
<tr class="memdesc:ad79f0f398b852781ef63b46fae4379a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">the quiz for which this instance computes grades. <br /></td></tr>
<tr class="separator:ad79f0f398b852781ef63b46fae4379a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4cda838b52c0d092f5c4dbfbc54ec68" id="r_ac4cda838b52c0d092f5c4dbfbc54ec68"><td class="memItemLeft" align="right" valign="top">stdClass[] null array&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac4cda838b52c0d092f5c4dbfbc54ec68">$slots</a> = null</td></tr>
<tr class="memdesc:ac4cda838b52c0d092f5c4dbfbc54ec68"><td class="mdescLeft">&#160;</td><td class="mdescRight">quiz_slot for this quiz.  <br /></td></tr>
<tr class="separator:ac4cda838b52c0d092f5c4dbfbc54ec68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae7e365543a621606a67ab7cf7a440af2" name="ae7e365543a621606a67ab7cf7a440af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7e365543a621606a67ab7cf7a440af2">&#9670;&#160;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::__construct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d84/classmod__quiz_1_1quiz__settings.html">quiz_settings</a></td>          <td class="paramname"><span class="paramname"><em>$quizobj</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Recommended way to get an instance is $quizobj-&gt;get_grade_calculator();</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">quiz_settings</td><td class="paramname">$quizobj</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a660d1d67afd81d5aee282d4050fb83bc" name="a660d1d67afd81d5aee282d4050fb83bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a660d1d67afd81d5aee282d4050fb83bc">&#9670;&#160;</a></span>compute_final_grade_from_attempts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::compute_final_grade_from_attempts </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$attempts</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the overall grade for a quiz given a number of attempts by a particular user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$attempts</td><td>an array of all the user's attempts at this quiz in order. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">float|null</td><td>the overall grade, or null if the user does not have a grade. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4531354ba65100bd5adc6ba0693f3942" name="a4531354ba65100bd5adc6ba0693f3942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4531354ba65100bd5adc6ba0693f3942">&#9670;&#160;</a></span>compute_grade_item_totals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::compute_grade_item_totals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html">question_usage_by_activity</a></td>          <td class="paramname"><span class="paramname"><em>$quba</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the grade and maximum for each item, for an attempt where the <a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a> is available. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d6/dc0/classquestion__usage__by__activity.html" title="This class keeps track of a group of questions that are being attempted, and which state,...">question_usage_by_activity</a></td><td class="paramname">$quba</td><td>usage for the quiz attempt we want to calculate the grades of. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">grade_out_of[]</td><td>the grade for each item where the total grade is not zero. -&gt;name will be set to the grade item name. Must be output through {</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d0/de1/group__core.html#ga5d853ba52ad6e416838c5dcc3680aa80" title="Given a simple string, this function returns the string processed by enabled string filters if $CFG-&gt;...">format_string()</a>}. </dd></dl>

</div>
</div>
<a id="ae69916707f4fddf7c89a1759f190d97a" name="ae69916707f4fddf7c89a1759f190d97a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae69916707f4fddf7c89a1759f190d97a">&#9670;&#160;</a></span>compute_grade_item_totals_for_attempts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::compute_grade_item_totals_for_attempts </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the grade and maximum for each item, for some attempts where we only have the usage ids. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int[]</td><td class="paramname">$qubaids</td><td>array of usage ids. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">grade_out_of[][]</td><td>question_usage.id =&gt; array of grade_out_of. -&gt;name will be set to the grade item name. Must be output through {</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d0/de1/group__core.html#ga5d853ba52ad6e416838c5dcc3680aa80" title="Given a simple string, this function returns the string processed by enabled string filters if $CFG-&gt;...">format_string()</a>}.. </dd></dl>

</div>
</div>
<a id="aba4b98c11d46693f4ec45a375b390ff3" name="aba4b98c11d46693f4ec45a375b390ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba4b98c11d46693f4ec45a375b390ff3">&#9670;&#160;</a></span>create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static mod_quiz\grade_calculator::create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d84/classmod__quiz_1_1quiz__settings.html">quiz_settings</a></td>          <td class="paramname"><span class="paramname"><em>$quizobj</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Factory. </p>
<p>The recommended way to get an instance is $quizobj-&gt;get_grade_calculator();</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">quiz_settings</td><td class="paramname">$quizobj</td><td>settings of a quiz. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">grade_calculator</td><td>instance of this class for the given quiz. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab9d37d78509648bccc616baa6c347913" name="ab9d37d78509648bccc616baa6c347913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9d37d78509648bccc616baa6c347913">&#9670;&#160;</a></span>ensure_grade_items_loaded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::ensure_grade_items_loaded </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ensure the {. </p>
<dl class="section see"><dt>See also</dt><dd>grade_calculator\$gradeitems} field is ready to use. </dd></dl>

</div>
</div>
<a id="ab74d7ecb5c284c1f7388bbdd18048e7d" name="ab74d7ecb5c284c1f7388bbdd18048e7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab74d7ecb5c284c1f7388bbdd18048e7d">&#9670;&#160;</a></span>ensure_slots_loaded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::ensure_slots_loaded </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ensure the {. </p>
<dl class="section see"><dt>See also</dt><dd>$gradeitems} field is ready to use. </dd></dl>

</div>
</div>
<a id="a101ec060f8277b37e34ad85604588a74" name="a101ec060f8277b37e34ad85604588a74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a101ec060f8277b37e34ad85604588a74">&#9670;&#160;</a></span>get_grade_items()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::get_grade_items </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the extra grade items for this quiz. </p>
<p>Returned objects have fields -&gt;id, -&gt;quizid, -&gt;sortorder, -&gt;name and maxmark. </p><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">stdClass[]</td><td>the grade items for this quiz. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a589d870dc62bcfbf2b63f04fda247302" name="a589d870dc62bcfbf2b63f04fda247302"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a589d870dc62bcfbf2b63f04fda247302">&#9670;&#160;</a></span>load_grade_item_totals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::load_grade_item_totals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html">qubaid_condition</a></td>          <td class="paramname"><span class="paramname"><em>$qubaids</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Query the database return the total mark for each grade item for a set of attempts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"><a class="el" href="../../d2/d58/classqubaid__condition.html" title="This class represents a restriction on the set of question_usage ids to include in a larger database ...">qubaid_condition</a></td><td class="paramname">$qubaids</td><td>which question_usages to computer the total marks for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">float[][]</td><td>Array question_usage.id =&gt; quiz_grade_item.id =&gt; mark. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac5246a32ce9ab07ffe15a1cf46185b7b" name="ac5246a32ce9ab07ffe15a1cf46185b7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5246a32ce9ab07ffe15a1cf46185b7b">&#9670;&#160;</a></span>recompute_all_final_grades()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::recompute_all_final_grades </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the final grade at this quiz for all students. </p>
<p>This function is equivalent to calling {</p><dl class="section see"><dt>See also</dt><dd>recompute_final_grade()} for all users who have attempted the quiz, but is much more efficient. </dd></dl>

</div>
</div>
<a id="a6132385f6363b5f324ada4eaf9d33cb7" name="a6132385f6363b5f324ada4eaf9d33cb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6132385f6363b5f324ada4eaf9d33cb7">&#9670;&#160;</a></span>recompute_final_grade()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::recompute_final_grade </td>
          <td>(</td>
          <td class="paramtype">?int</td>          <td class="paramname"><span class="paramname"><em>$userid</em></span><span class="paramdefsep"> = </span><span class="paramdefval">null</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$attempts</em></span><span class="paramdefsep"> = </span><span class="paramdefval">[]</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the final grade at this quiz for a particular student. </p>
<p>That is, given the quiz settings, and all the attempts this user has made, compute their final grade for the quiz, as shown in the gradebook.</p>
<p>The $attempts parameter is for efficiency. If you already have the data for all this user's attempts loaded (for example from {</p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../dd/df0/group__mod__quiz.html#gaca61ccc566b7929aa5935a836b1861f0">quiz_get_user_attempts()</a>} or because you are looping through a large recordset fetched in one efficient query, then you can pass that data here to save <a class="el" href="../../d1/dc8/class_d_b.html" title="The main &quot;DB&quot; class is simply a container class with some static methods for creating DB objects as w...">DB</a> queries.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int&#160;|&#160;null</td><td class="paramname">$userid</td><td>The userid to calculate the grade for. Defaults to the current user. </td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$attempts</td><td>if you already have this user's attempt records loaded, pass them here to save queries. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acbc437fef90b47cf5c66f62d15c1875d" name="acbc437fef90b47cf5c66f62d15c1875d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbc437fef90b47cf5c66f62d15c1875d">&#9670;&#160;</a></span>recompute_quiz_sumgrades()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::recompute_quiz_sumgrades </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the sumgrades field of the quiz. </p>
<p>This needs to be called whenever the grading structure of the quiz is changed. For example if a question is added or removed, or a question weight is changed.</p>
<p>You should call {</p><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../dd/df0/group__mod__quiz.html#gab597cb872eb48b9d68193c94e7a0b439" title="Delete all the preview attempts at a quiz, or possibly all the attempts belonging to one user.">quiz_delete_previews()</a>} before you <a class="el" href="../../d6/d9f/group__moodlecore.html#gaa731f016ddefcd9a6ec52a6fe3c2194a" title="To use the phpFlickr\call method, pass a string containing the API method you want to use and an asso...">call</a> this function. </dd></dl>

</div>
</div>
<a id="ad53b744f462cee81885a6efc5da01e4a" name="ad53b744f462cee81885a6efc5da01e4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad53b744f462cee81885a6efc5da01e4a">&#9670;&#160;</a></span>set_slots()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::set_slots </td>
          <td>(</td>
          <td class="paramtype">array</td>          <td class="paramname"><span class="paramname"><em>$slots</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lets other code pass in the slot information, so it does note have to be re-loaded from the <a class="el" href="../../d1/dc8/class_d_b.html" title="The main &quot;DB&quot; class is simply a container class with some static methods for creating DB objects as w...">DB</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">stdClass[]</td><td class="paramname">$slots</td><td>the data from quiz_slots. The only required fields are -&gt;slot and -&gt;quizgradeitemid. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aec3b15686c9e071b175a34bbcb3358f0" name="aec3b15686c9e071b175a34bbcb3358f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec3b15686c9e071b175a34bbcb3358f0">&#9670;&#160;</a></span>update_quiz_maximum_grade()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mod_quiz\grade_calculator::update_quiz_maximum_grade </td>
          <td>(</td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>$newgrade</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the quiz setting for the grade the quiz is out of. </p>
<p>This function will update the data in quiz_grades and quiz_feedback, and pass the new grades on to the gradebook.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">float</td><td class="paramname">$newgrade</td><td>the new maximum grade for the quiz. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a444904108199ebb3adf782e36dc1fe00" name="a444904108199ebb3adf782e36dc1fe00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a444904108199ebb3adf782e36dc1fe00">&#9670;&#160;</a></span>$gradeitems</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">stdClass [] null array mod_quiz\grade_calculator::$gradeitems = null</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>quiz_grade_items for this quiz indexed by id, sorted by sortorder, with a maxmark field added. </p>
<p>Lazy-loaded when needed. See {</p><dl class="section see"><dt>See also</dt><dd>ensure_grade_items_loaded()}. </dd></dl>

</div>
</div>
<a id="ac4cda838b52c0d092f5c4dbfbc54ec68" name="ac4cda838b52c0d092f5c4dbfbc54ec68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4cda838b52c0d092f5c4dbfbc54ec68">&#9670;&#160;</a></span>$slots</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">stdClass [] null array mod_quiz\grade_calculator::$slots = null</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>quiz_slot for this quiz. </p>
<p>Only -&gt;slot and -&gt;quizgradeitemid fields are used.</p>
<p>This is either set by another class that already has the data, using {</p><dl class="section see"><dt>See also</dt><dd>set_slots()} or it is lazy-loaded when needed. See {</dd>
<dd>
ensure_slots_loaded()}. </dd></dl>

</div>
</div>
<a id="a2884310a823320865e97b53f432323e7" name="a2884310a823320865e97b53f432323e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2884310a823320865e97b53f432323e7">&#9670;&#160;</a></span>ALMOST_ZERO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float const mod_quiz\grade_calculator::ALMOST_ZERO = 0.000005</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>a number that is effectively zero. </p>
<p>Used to avoid division-by-zero or underflow problems. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>mod/quiz/classes/<b>grade_calculator.php</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 26 2024 02:47:54 for Moodle PHP Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
